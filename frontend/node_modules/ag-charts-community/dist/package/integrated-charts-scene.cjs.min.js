"use strict";var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__hasOwnProp=Object.prototype.hasOwnProperty,__export=(e,t)=>{for(var n in t)__defProp(e,n,{get:t[n],enumerable:!0})},__copyProps=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of __getOwnPropNames(t))!__hasOwnProp.call(e,s)&&s!==n&&__defProp(e,s,{get:()=>t[s],enumerable:!(i=__getOwnPropDesc(t,s))||i.enumerable});return e},__toCommonJS=e=>__copyProps(__defProp({},"__esModule",{value:!0}),e),__decorateClass=(e,t,n,i)=>{for(var s=i>1?void 0:i?__getOwnPropDesc(t,n):t,r=e.length-1,a;r>=0;r--)(a=e[r])&&(s=(i?a(t,n,s):a(s))||s);return i&&s&&__defProp(t,n,s),s},integrated_charts_scene_exports={};__export(integrated_charts_scene_exports,{Arc:()=>Arc,BBox:()=>BBox,BandScale:()=>BandScale,Caption:()=>Caption,Circle:()=>Circle,Group:()=>Group,Line:()=>Line,LinearScale:()=>LinearScale,Path:()=>Path,RadialColumnShape:()=>RadialColumnShape,Rect:()=>Rect,Scene:()=>Scene,Sector:()=>Sector,Shape:()=>Shape,TranslatableGroup:()=>TranslatableGroup,getRadialColumnWidth:()=>getRadialColumnWidth,toRadians:()=>toRadians}),module.exports=__toCommonJS(integrated_charts_scene_exports);var ID_MAP=new Map;function createId(e){const t=e.constructor,n=Object.hasOwn(t,"className")?t.className:t.name;if(!n)throw new Error(`The ${t} is missing the 'className' property.`);const i=(ID_MAP.get(n)??0)+1;return ID_MAP.set(n,i),`${n}-${i}`}function toIterable(e){return e!=null&&typeof e=="object"&&Symbol.iterator in e?e:[e]}var BBoxValues={containsPoint,isEmpty,normalize};function containsPoint(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function isEmpty(e){return e==null||e.height===0||e.width===0||isNaN(e.height)||isNaN(e.width)}function normalize(e){let{x:t,y:n,width:i,height:s}=e;return(i==null||i>0)&&(s==null||s>0)?e:(t!=null&&i!=null&&i<0&&(i=-i,t=t-i),n!=null&&s!=null&&s<0&&(s=-s,n=n-s),{x:t,y:n,width:i,height:s})}var interpolate=Symbol("interpolate");function nearestSquared(e,t,n,i=1/0){const s={nearest:void 0,distanceSquared:i};for(const r of n){const a=r.distanceSquared(e,t);if(a===0)return{nearest:r,distanceSquared:0};a<s.distanceSquared&&(s.nearest=r,s.distanceSquared=a)}return s}function clamp(e,t,n){return Math.min(n,Math.max(e,t))}function findMinMax(e){if(e.length===0)return[];const t=[1/0,-1/0];for(const n of e)n<t[0]&&(t[0]=n),n>t[1]&&(t[1]=n);return t}function isNumberEqual(e,t,n=1e-10){return Math.abs(e-t)<n}function countFractionDigits(e){if(Math.floor(e)===e)return 0;let t=String(e),n=0;if(e<1e-6||e>=1e21){let s;[t,s]=t.split("e"),s!=null&&(n=Number(s))}const i=t.split(".")[1]?.length??0;return Math.max(i-n,0)}var _BBox=class ${constructor(t,n,i,s){this.x=t,this.y=n,this.width=i,this.height=s}static fromDOMRect({x:t,y:n,width:i,height:s}){return new $(t,n,i,s)}static merge(t){let n=1/0,i=1/0,s=-1/0,r=-1/0;for(const a of t)a.x<n&&(n=a.x),a.y<i&&(i=a.y),a.x+a.width>s&&(s=a.x+a.width),a.y+a.height>r&&(r=a.y+a.height);return new $(n,i,s-n,r-i)}static nearestBox(t,n,i){return nearestSquared(t,n,i)}toDOMRect(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.y,left:this.x,right:this.x+this.width,bottom:this.y+this.height,toJSON(){return{}}}}clone(){const{x:t,y:n,width:i,height:s}=this;return new $(t,n,i,s)}equals(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}containsPoint(t,n){return BBoxValues.containsPoint(this,t,n)}containsBBox(t){const[n,i]=[this.x,this.x+this.width],[s,r]=[this.y,this.y+this.height],[a,h]=[t.x,t.x+t.width],[o,c]=[t.y,t.y+t.height];return Math.min(n,a)===n&&Math.max(i,h)===i&&Math.min(s,o)===s&&Math.max(r,c)===r}intersection(t){if(!this.collidesBBox(t))return;const n=clamp(t.x,this.x,t.x+t.width),i=clamp(t.y,this.y,t.y+t.height),s=clamp(t.x,this.x+this.width,t.x+t.width),r=clamp(t.y,this.y+this.height,t.y+t.height);return new $(n,i,s-n,r-i)}collidesBBox(t){return this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.y+this.height>t.y}computeCenter(){return{x:this.x+this.width/2,y:this.y+this.height/2}}isFinite(){return Number.isFinite(this.x)&&Number.isFinite(this.y)&&Number.isFinite(this.width)&&Number.isFinite(this.height)}distanceSquared(t,n){if(this.containsPoint(t,n))return 0;const i=t-clamp(this.x,t,this.x+this.width),s=n-clamp(this.y,n,this.y+this.height);return i*i+s*s}shrink(t,n){if(typeof t=="number")this.applyMargin(t,n);else for(const[i,s]of Object.entries(t))this.applyMargin(s,i);return this.width<0&&(this.width=0),this.height<0&&(this.height=0),this}grow(t,n){if(typeof t=="number")this.applyMargin(-t,n);else for(const[i,s]of Object.entries(t))this.applyMargin(-s,i);return this}applyMargin(t,n){switch(n){case"top":this.y+=t;case"bottom":this.height-=t;break;case"left":this.x+=t;case"right":this.width-=t;break;case"vertical":this.y+=t,this.height-=t*2;break;case"horizontal":this.x+=t,this.width-=t*2;break;case void 0:this.x+=t,this.y+=t,this.width-=t*2,this.height-=t*2;break}}translate(t,n){return this.x+=t,this.y+=n,this}combine(t){const{x:n,y:i,width:s,height:r}=this;this.x=Math.min(n,t.x),this.y=Math.min(i,t.y),this.width=Math.max(n+s,t.x+t.width)-this.x,this.height=Math.max(i+r,t.y+t.height)-this.y}[interpolate](t,n){return new $(this.x*(1-n)+t.x*n,this.y*(1-n)+t.y*n,this.width*(1-n)+t.width*n,this.height*(1-n)+t.height*n)}};_BBox.zero=Object.freeze(new _BBox(0,0,0,0)),_BBox.NaN=Object.freeze(new _BBox(NaN,NaN,NaN,NaN));var BBox=_BBox;function SceneChangeDetection(e){return function(t,n){const i=`__${n}`;t[n]||prepareGetSet(t,n,i,e)}}function prepareGetSet(e,t,n,i){const{type:s="normal",changeCb:r,convertor:a,checkDirtyOnAssignment:h=!1}=i??{},o={type:s,changeCb:r,checkDirtyOnAssignment:h,convertor:a};let c;switch(s){case"normal":c=buildNormalSetter(n,o);break;case"transform":c=buildTransformSetter(n);break;case"path":c=buildPathSetter(n);break}c=buildCheckDirtyChain(buildChangeCallbackChain(buildConvertorChain(c,o),o),o),Object.defineProperty(e,t,{set:c,get:function(){return this[n]},enumerable:!0,configurable:!0})}function buildConvertorChain(e,t){const{convertor:n}=t;return n?function(i){e.call(this,n(i))}:e}var NO_CHANGE=Symbol("no-change");function buildChangeCallbackChain(e,t){const{changeCb:n}=t;return n?function(i){const s=e.call(this,i);return s!==NO_CHANGE&&n.call(this,this),s}:e}function buildCheckDirtyChain(e,t){const{checkDirtyOnAssignment:n}=t;return n?function(i){const s=e.call(this,i);return s!==NO_CHANGE&&i?._dirty===!0&&this.markDirty(),s}:e}function buildNormalSetter(e,t){const{changeCb:n}=t;return function(i){const s=this[e];return i!==s?(this[e]=i,this.markDirty(),n?.(this),i):NO_CHANGE}}function buildTransformSetter(e){return function(t){const n=this[e];return t!==n?(this[e]=t,this.markDirtyTransform(),t):NO_CHANGE}}function buildPathSetter(e){return function(t){const n=this[e];return t!==n?(this[e]=t,this._dirtyPath||(this._dirtyPath=!0,this.markDirty()),t):NO_CHANGE}}var _Node=class it{constructor(t){this.serialNumber=it._nextSerialNumber++,this.childNodeCounts={groups:0,nonGroups:0,thisComplexity:0,complexity:0},this.id=createId(this),this.pointerEvents=0,this._dirty=!0,this.dirtyZIndex=!1,this.isContainerNode=!1,this.visible=!0,this.zIndex=0,this.name=t?.name,this.tag=t?.tag??NaN,this.zIndex=t?.zIndex??0}static toSVG(t,n,i){const s=t?.toSVG();if(s==null||!s.elements.length&&!s.defs?.length)return;const r=document.createElementNS("http://www.w3.org/2000/svg","svg");if(r.setAttribute("width",String(n)),r.setAttribute("height",String(i)),r.setAttribute("viewBox",`0 0 ${n} ${i}`),s.defs?.length){const a=document.createElementNS("http://www.w3.org/2000/svg","defs");a.append(...s.defs),r.append(a)}return r.append(...s.elements),r.outerHTML}static*extractBBoxes(t,n){for(const i of t)if(!n||i.visible&&!i.transitionOut){const s=i.getBBox();s&&(yield s)}}get datum(){return this._datum??this.parentNode?.datum}set datum(t){this._datum!==t&&(this._previousDatum=this._datum,this._datum=t)}get previousDatum(){return this._previousDatum}get layerManager(){return this._layerManager}get dirty(){return this._dirty}preRender(t=1){this.childNodeCounts.groups=0,this.childNodeCounts.nonGroups=1,this.childNodeCounts.complexity=t,this.childNodeCounts.thisComplexity=t;for(const n of this.children()){const i=n.preRender();this.childNodeCounts.groups+=i.groups,this.childNodeCounts.nonGroups+=i.nonGroups,this.childNodeCounts.complexity+=i.complexity}return this.childNodeCounts}render(t){const{stats:n}=t;if(this._dirty=!1,t.debugNodeSearch){const i=this.name??this.id;t.debugNodeSearch.some(s=>typeof s=="string"?s===i:s.test(i))&&(t.debugNodes[this.name??this.id]=this)}n&&(n.nodesRendered++,n.opsPerformed+=this.childNodeCounts.thisComplexity)}_setLayerManager(t){this._layerManager=t,this._debug=t?.debug;for(const n of this.children())n._setLayerManager(t)}sortChildren(t){if(this.dirtyZIndex=!1,!this.childNodes)return;const n=[...this.childNodes].sort(t);this.childNodes.clear();for(const i of n)this.childNodes.add(i)}*traverseUp(t){let n=this;for(t&&(yield n);n=n.parentNode;)yield n}*children(){if(this.childNodes)for(const t of this.childNodes)yield t}isLeaf(){return!this.childNodes?.size}isRoot(){return!this.parentNode}append(t){this.childNodes??(this.childNodes=new Set);for(const n of toIterable(t))n.parentNode?.removeChild(n),this.childNodes.add(n),n.parentNode=this,n._setLayerManager(this.layerManager);this.invalidateCachedBBox(),this.dirtyZIndex=!0,this.markDirty()}appendChild(t){return this.append(t),t}removeChild(t){return this.childNodes?.delete(t)?(delete t.parentNode,t._setLayerManager(),this.invalidateCachedBBox(),this.dirtyZIndex=!0,this.markDirty(),!0):!1}remove(){return this.parentNode?.removeChild(this)??!1}clear(){for(const t of this.children())delete t.parentNode,t._setLayerManager();this.childNodes?.clear(),this.invalidateCachedBBox()}destroy(){this.parentNode?.removeChild(this)}setProperties(t,n){if(n)for(const i of n)this[i]=t[i];else Object.assign(this,t);return this}containsPoint(t,n){return!1}pickNode(t,n,i=!1){if(!this.visible||this.pointerEvents===1||!this.containsPoint(t,n))return;const s=[...this.children()];if(s.length>1e3)for(let r=s.length-1;r>=0;r--){const a=s[r],o=a.containsPoint(t,n)?a.pickNode(t,n):void 0;if(o)return o}else if(s.length)for(let r=s.length-1;r>=0;r--){const a=s[r].pickNode(t,n);if(a)return a}else if(!this.isContainerNode)return this}invalidateCachedBBox(){this.cachedBBox!=null&&(this.cachedBBox=void 0,this.parentNode?.invalidateCachedBBox())}getBBox(){return this.cachedBBox==null&&(this.cachedBBox=Object.freeze(this.computeBBox())),this.cachedBBox}computeBBox(){}markDirty(){const{_dirty:t}=this;this.cachedBBox==null&&t||(this.invalidateCachedBBox(),this._dirty=!0,this.parentNode&&this.parentNode.markDirty())}markClean(){if(this._dirty){this._dirty=!1;for(const t of this.children())t.markClean()}}onZIndexChange(){const{parentNode:t}=this;t&&(t.dirtyZIndex=!0)}toSVG(){}};_Node._nextSerialNumber=0,__decorateClass([SceneChangeDetection()],_Node.prototype,"visible",2),__decorateClass([SceneChangeDetection({changeCb:e=>e.onZIndexChange()})],_Node.prototype,"zIndex",2);var Node=_Node;function createCanvasContext(e=0,t=0){return new OffscreenCanvas(e,t).getContext("2d")}var LRUCache=class{constructor(e=5){this.maxCacheSize=e,this.store=new Map}get(e){if(!this.store.has(e))return;const t=this.store.get(e);return this.store.delete(e),this.store.set(e,t),t}has(e){return this.store.has(e)}set(e,t){if(this.store.set(e,t),this.store.size>this.maxCacheSize){const n=this.store.keys();let i=this.store.size-this.maxCacheSize;for(;i>0;){const s=n.next();s.done||this.store.delete(s.value),i--}}return t}clear(){this.store.clear()}},CachedTextMeasurerPool=class{static measureText(e,t){return this.getMeasurer(t).measureText(e)}static measureLines(e,t){return this.getMeasurer(t).measureLines(e)}static getMeasurer(e){const t=typeof e.font=="string"?e.font:TextUtils.toFontString(e.font),n=`${t}-${e.textAlign??"start"}-${e.textBaseline??"alphabetic"}`;return this.instanceMap.get(n)??this.createFontMeasurer(t,e,n)}static createFontMeasurer(e,t,n){const i=createCanvasContext();i.font=e,i.textAlign=t.textAlign??"start",i.textBaseline=t.textBaseline??"alphabetic";const s=new CachedTextMeasurer(i,t);return this.instanceMap.set(n,s),s}};CachedTextMeasurerPool.instanceMap=new LRUCache(10);var CachedTextMeasurer=class{constructor(e,t){this.ctx=e,this.measureMap=new LRUCache(100),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline),e.font=typeof t.font=="string"?t.font:TextUtils.toFontString(t.font),this.textMeasurer=new SimpleTextMeasurer(n=>this.cachedCtxMeasureText(n),t.textBaseline??"alphabetic")}textWidth(e,t){return this.textMeasurer.textWidth(e,t)}measureText(e){return this.textMeasurer.measureText(e)}measureLines(e){return this.textMeasurer.measureLines(e)}cachedCtxMeasureText(e){if(!this.measureMap.has(e)){const t=this.ctx.measureText(e);this.measureMap.set(e,{actualBoundingBoxAscent:t.actualBoundingBoxAscent,emHeightAscent:t.emHeightAscent,emHeightDescent:t.emHeightDescent,actualBoundingBoxDescent:t.actualBoundingBoxDescent,actualBoundingBoxLeft:t.actualBoundingBoxLeft,actualBoundingBoxRight:t.actualBoundingBoxRight,alphabeticBaseline:t.alphabeticBaseline,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent,hangingBaseline:t.hangingBaseline,ideographicBaseline:t.ideographicBaseline,width:t.width})}return this.measureMap.get(e)}},TextUtils=class{static toFontString({fontSize:e=10,fontStyle:t,fontWeight:n,fontFamily:i,lineHeight:s}){let r="";return t&&(r+=`${t} `),n&&(r+=`${n} `),r+=`${e}px`,s&&(r+=`/${s}px`),r+=` ${i}`,r.trim()}static getLineHeight(e){return Math.ceil(e*this.defaultLineHeight)}static getVerticalModifier(e){switch(e){case"hanging":case"top":return 0;case"middle":return .5;case"alphabetic":case"bottom":case"ideographic":default:return 1}}};TextUtils.EllipsisChar="\u2026",TextUtils.defaultLineHeight=1.15,TextUtils.lineSplitter=/\r?\n/g;var SimpleTextMeasurer=class{constructor(e,t="alphabetic"){this.measureTextFn=e,this.textBaseline=t,this.charMap=new Map}getMetrics(e){const t=this.measureTextFn(e);return t.fontBoundingBoxAscent??(t.fontBoundingBoxAscent=t.emHeightAscent),t.fontBoundingBoxDescent??(t.fontBoundingBoxDescent=t.emHeightDescent),{width:t.width,height:t.actualBoundingBoxAscent+t.actualBoundingBoxDescent,lineHeight:t.fontBoundingBoxAscent+t.fontBoundingBoxDescent,offsetTop:t.actualBoundingBoxAscent,offsetLeft:t.actualBoundingBoxLeft}}getMultilineMetrics(e){let t=0,n=0,i=0,s=0,r=0;const a=TextUtils.getVerticalModifier(this.textBaseline),h=[];let o=0;const c=e.length;for(const l of e){const u=this.measureTextFn(l);u.fontBoundingBoxAscent??(u.fontBoundingBoxAscent=u.emHeightAscent),u.fontBoundingBoxDescent??(u.fontBoundingBoxDescent=u.emHeightDescent),t<u.width&&(t=u.width),s<u.actualBoundingBoxLeft&&(s=u.actualBoundingBoxLeft),o===0?(n+=u.actualBoundingBoxAscent,i+=u.actualBoundingBoxAscent):r+=u.fontBoundingBoxAscent,o===c-1?n+=u.actualBoundingBoxDescent:r+=u.fontBoundingBoxDescent,h.push({text:l,width:u.width,height:u.actualBoundingBoxAscent+u.actualBoundingBoxDescent,lineHeight:u.fontBoundingBoxAscent+u.fontBoundingBoxDescent,offsetTop:u.actualBoundingBoxAscent,offsetLeft:u.actualBoundingBoxLeft}),o++}return n+=r,i+=r*a,{width:t,height:n,offsetTop:i,offsetLeft:s,lineMetrics:h}}textWidth(e,t){if(t){let n=0;for(let i=0;i<e.length;i++)n+=this.textWidth(e.charAt(i));return n}return e.length>1?this.measureTextFn(e).width:this.charMap.get(e)??this.charWidth(e)}measureText(e){return this.getMetrics(e)}measureLines(e){const t=typeof e=="string"?e.split(TextUtils.lineSplitter):e;return this.getMultilineMetrics(t)}charWidth(e){const{width:t}=this.measureTextFn(e);return this.charMap.set(e,t),t}},IDENTITY_MATRIX_ELEMENTS=[1,0,0,1,0,0];function closeValue(e,t,n=1e-8){return e===t||Math.abs(t-e)<n}var _Matrix=class G{get e(){return[...this.elements]}constructor(t=[...IDENTITY_MATRIX_ELEMENTS]){this.elements=t}setElements(t){const n=this.elements;return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],this}get identity(){const t=this.elements;return closeValue(t[0],1)&&closeValue(t[1],0)&&closeValue(t[2],0)&&closeValue(t[3],1)&&closeValue(t[4],0)&&closeValue(t[5],0)}AxB(t,n,i){const s=t[0]*n[0]+t[2]*n[1],r=t[1]*n[0]+t[3]*n[1],a=t[0]*n[2]+t[2]*n[3],h=t[1]*n[2]+t[3]*n[3],o=t[0]*n[4]+t[2]*n[5]+t[4],c=t[1]*n[4]+t[3]*n[5]+t[5];i=i??t,i[0]=s,i[1]=r,i[2]=a,i[3]=h,i[4]=o,i[5]=c}multiplySelf(t){return this.AxB(this.elements,t.elements),this}multiply(t){const n=new Array(6);return t instanceof G?this.AxB(this.elements,t.elements,n):this.AxB(this.elements,[t.a,t.b,t.c,t.d,t.e,t.f],n),new G(n)}preMultiplySelf(t){return this.AxB(t.elements,this.elements,this.elements),this}inverse(){const t=this.elements;let n=t[0],i=t[1],s=t[2],r=t[3];const a=t[4],h=t[5],o=1/(n*r-i*s);return n*=o,i*=o,s*=o,r*=o,new G([r,-i,-s,n,s*h-r*a,i*a-n*h])}inverseTo(t){const n=this.elements;let i=n[0],s=n[1],r=n[2],a=n[3];const h=n[4],o=n[5],c=1/(i*a-s*r);return i*=c,s*=c,r*=c,a*=c,t.setElements([a,-s,-r,i,r*o-a*h,s*h-i*o]),this}invertSelf(){const t=this.elements;let n=t[0],i=t[1],s=t[2],r=t[3];const a=t[4],h=t[5],o=1/(n*r-i*s);return n*=o,i*=o,s*=o,r*=o,t[0]=r,t[1]=-i,t[2]=-s,t[3]=n,t[4]=s*h-r*a,t[5]=i*a-n*h,this}transformPoint(t,n){const i=this.elements;return{x:t*i[0]+n*i[2]+i[4],y:t*i[1]+n*i[3]+i[5]}}transformBBox(t,n){const i=this.elements,s=i[0],r=i[1],a=i[2],h=i[3],o=t.width*.5,c=t.height*.5,l=t.x+o,u=t.y+c,d=Math.abs(o*s)+Math.abs(c*a),f=Math.abs(o*r)+Math.abs(c*h);return n??(n=new BBox(0,0,0,0)),n.x=l*s+u*a+i[4]-d,n.y=l*r+u*h+i[5]-f,n.width=d+d,n.height=f+f,n}toContext(t){if(this.identity)return;const n=this.elements;t.transform(n[0],n[1],n[2],n[3],n[4],n[5])}static flyweight(t){return G.instance.setElements(t.elements)}static updateTransformMatrix(t,n,i,s,r,a,h){const o=n,c=i;let l,u;o===1&&c===1?(l=0,u=0):(l=h?.scalingCenterX??0,u=h?.scalingCenterY??0);const d=s,f=Math.cos(d),p=Math.sin(d);let m,g;d===0?(m=0,g=0):(m=h?.rotationCenterX??0,g=h?.rotationCenterY??0);const y=r,M=a,v=l*(1-o)-m,R=u*(1-c)-g;return t.setElements([f*o,p*o,-p*c,f*c,f*v-p*R+m+y,p*v+f*R+g+M]),t}static fromContext(t){const n=t.getTransform();return new G([n.a,n.b,n.c,n.d,n.e,n.f])}};_Matrix.instance=new _Matrix;var Matrix=_Matrix;function isMatrixTransform(e){return isMatrixTransformType(e.constructor)}var MATRIX_TRANSFORM_TYPE=Symbol("isMatrixTransform");function isMatrixTransformType(e){return e[MATRIX_TRANSFORM_TYPE]===!0}function MatrixTransform(e){var t,n;const i=e;if(isMatrixTransformType(e))return e;const s=Symbol("matrix_combined_transform");class r extends i{constructor(){super(...arguments),this[n]=new Matrix,this._dirtyTransform=!0}markDirtyTransform(){this._dirtyTransform=!0,super.markDirty()}updateMatrix(h){}computeTransformMatrix(){this._dirtyTransform&&(this[s].setElements(IDENTITY_MATRIX_ELEMENTS),this.updateMatrix(this[s]),this._dirtyTransform=!1)}toParent(h){return this.computeTransformMatrix(),this[s].identity?h.clone():this[s].transformBBox(h)}toParentPoint(h,o){return this.computeTransformMatrix(),this[s].identity?{x:h,y:o}:this[s].transformPoint(h,o)}fromParent(h){return this.computeTransformMatrix(),this[s].identity?h.clone():this[s].inverse().transformBBox(h)}fromParentPoint(h,o){return this.computeTransformMatrix(),this[s].identity?{x:h,y:o}:this[s].inverse().transformPoint(h,o)}computeBBox(){const h=super.computeBBox();return h&&this.toParent(h)}computeBBoxWithoutTransforms(){return super.computeBBox()}pickNode(h,o,c=!1){return c||({x:h,y:o}=this.fromParentPoint(h,o)),super.pickNode(h,o)}render(h){this.computeTransformMatrix();const{ctx:o}=h,c=this[s];let l=!1;c.identity||(o.save(),l=!0,c.toContext(o)),super.render(h),l&&o.restore()}toSVG(){this.computeTransformMatrix();const h=super.toSVG(),o=this[s];if(o.identity||h==null)return h;const c=document.createElementNS("http://www.w3.org/2000/svg","g");c.append(...h.elements);const[l,u,d,f,p,m]=o.e;return c.setAttribute("transform",`matrix(${l} ${u} ${d} ${f} ${p} ${m})`),{elements:[c],defs:h.defs}}}return t=MATRIX_TRANSFORM_TYPE,n=s,r[t]=!0,r}function Rotatable(e){var t;const n=e,i=Symbol("matrix_rotation");class s extends MatrixTransform(n){constructor(){super(...arguments),this[t]=new Matrix,this.rotationCenterX=null,this.rotationCenterY=null,this.rotation=0}updateMatrix(a){super.updateMatrix(a);const{rotation:h,rotationCenterX:o,rotationCenterY:c}=this;h!==0&&(Matrix.updateTransformMatrix(this[i],1,1,h,0,0,{rotationCenterX:o,rotationCenterY:c}),a.multiplySelf(this[i]))}}return t=i,__decorateClass([SceneChangeDetection({type:"transform"})],s.prototype,"rotationCenterX",2),__decorateClass([SceneChangeDetection({type:"transform"})],s.prototype,"rotationCenterY",2),__decorateClass([SceneChangeDetection({type:"transform"})],s.prototype,"rotation",2),s}function Scalable(e){var t;const n=e,i=Symbol("matrix_scale");class s extends MatrixTransform(n){constructor(){super(...arguments),this[t]=new Matrix,this.scalingX=1,this.scalingY=1,this.scalingCenterX=null,this.scalingCenterY=null}updateMatrix(a){super.updateMatrix(a);const{scalingX:h,scalingY:o,scalingCenterX:c,scalingCenterY:l}=this;h===1&&o===1||(Matrix.updateTransformMatrix(this[i],h,o,0,0,0,{scalingCenterX:c,scalingCenterY:l}),a.multiplySelf(this[i]))}}return t=i,__decorateClass([SceneChangeDetection({type:"transform"})],s.prototype,"scalingX",2),__decorateClass([SceneChangeDetection({type:"transform"})],s.prototype,"scalingY",2),__decorateClass([SceneChangeDetection({type:"transform"})],s.prototype,"scalingCenterX",2),__decorateClass([SceneChangeDetection({type:"transform"})],s.prototype,"scalingCenterY",2),s}function Translatable(e){var t;const n=e,i=Symbol("matrix_translation");class s extends MatrixTransform(n){constructor(){super(...arguments),this[t]=new Matrix,this.translationX=0,this.translationY=0}updateMatrix(a){super.updateMatrix(a);const{translationX:h,translationY:o}=this;h===0&&o===0||(Matrix.updateTransformMatrix(this[i],1,1,0,h,o),a.multiplySelf(this[i]))}}return t=i,__decorateClass([SceneChangeDetection({type:"transform"})],s.prototype,"translationX",2),__decorateClass([SceneChangeDetection({type:"transform"})],s.prototype,"translationY",2),s}var Transformable=class{static fromCanvas(e,t){const n=[];for(const i of e.traverseUp())isMatrixTransform(i)&&n.unshift(i);for(const i of n)t=i.fromParent(t);return isMatrixTransform(e)&&(t=e.fromParent(t)),t}static toCanvas(e,t){t==null?t=e.getBBox():isMatrixTransform(e)&&(t=e.toParent(t));for(const n of e.traverseUp())isMatrixTransform(n)&&(t=n.toParent(t));return t}static fromCanvasPoint(e,t,n){const i=[];for(const s of e.traverseUp())isMatrixTransform(s)&&i.unshift(s);for(const s of i)({x:t,y:n}=s.fromParentPoint(t,n));return isMatrixTransform(e)&&({x:t,y:n}=e.fromParentPoint(t,n)),{x:t,y:n}}static toCanvasPoint(e,t,n){isMatrixTransform(e)&&({x:t,y:n}=e.toParentPoint(t,n));for(const i of e.traverseUp())isMatrixTransform(i)&&({x:t,y:n}=i.toParentPoint(t,n));return{x:t,y:n}}},lerp=(e,t,n)=>e*(1-n)+t*n,srgbToLinear=e=>{const t=e<0?-1:1,n=Math.abs(e);return n<=.04045?e/12.92:t*((n+.055)/1.055)**2.4},srgbFromLinear=e=>{const t=e<0?-1:1,n=Math.abs(e);return n>.0031308?t*(1.055*n**(1/2.4)-.055):12.92*e},_Color=class A{constructor(t,n,i,s=1){this.r=clamp(0,t||0,1),this.g=clamp(0,n||0,1),this.b=clamp(0,i||0,1),this.a=clamp(0,s||0,1)}static validColorString(t){return t.indexOf("#")>=0?!!A.parseHex(t):t.indexOf("rgb")>=0?!!A.stringToRgba(t):!!A.nameToHex.has(t.toLowerCase())}static fromString(t){if(t.indexOf("#")>=0)return A.fromHexString(t);const n=A.nameToHex.get(t.toLowerCase());if(n)return A.fromHexString(n);if(t.indexOf("rgb")>=0)return A.fromRgbaString(t);throw new Error(`Invalid color string: '${t}'`)}static parseHex(t){t=t.replace(/ /g,"").slice(1);let n;switch(t.length){case 6:case 8:n=[];for(let i=0;i<t.length;i+=2)n.push(parseInt(`${t[i]}${t[i+1]}`,16));break;case 3:case 4:n=t.split("").map(i=>parseInt(i,16)).map(i=>i+i*16);break}if(n?.length>=3&&n.every(i=>i>=0))return n.length===3&&n.push(255),n}static fromHexString(t){const n=A.parseHex(t);if(n){const[i,s,r,a]=n;return new A(i/255,s/255,r/255,a/255)}throw new Error(`Malformed hexadecimal color string: '${t}'`)}static stringToRgba(t){let n=-1,i=-1;for(let h=0;h<t.length;h++){const o=t[h];if(n===-1&&o==="(")n=h;else if(o===")"){i=h;break}}if(n===-1||i===-1)return;const r=t.substring(n+1,i).split(","),a=[];for(let h=0;h<r.length;h++){const o=r[h];let c=parseFloat(o);if(!Number.isFinite(c))return;o.indexOf("%")>=0?(c=clamp(0,c,100),c/=100):h===3?c=clamp(0,c,1):(c=clamp(0,c,255),c/=255),a.push(c)}return a}static fromRgbaString(t){const n=A.stringToRgba(t);if(n){if(n.length===3)return new A(n[0],n[1],n[2]);if(n.length===4)return new A(n[0],n[1],n[2],n[3])}throw new Error(`Malformed rgb/rgba color string: '${t}'`)}static fromArray(t){if(t.length===4)return new A(t[0],t[1],t[2],t[3]);if(t.length===3)return new A(t[0],t[1],t[2]);throw new Error("The given array should contain 3 or 4 color components (numbers).")}static fromHSB(t,n,i,s=1){const r=A.HSBtoRGB(t,n,i);return new A(r[0],r[1],r[2],s)}static fromHSL(t,n,i,s=1){const r=A.HSLtoRGB(t,n,i);return new A(r[0],r[1],r[2],s)}static fromOKLCH(t,n,i,s=1){const r=A.OKLCHtoRGB(t,n,i);return new A(r[0],r[1],r[2],s)}static padHex(t){return t.length===1?"0"+t:t}toHexString(){let t="#"+A.padHex(Math.round(this.r*255).toString(16))+A.padHex(Math.round(this.g*255).toString(16))+A.padHex(Math.round(this.b*255).toString(16));return this.a<1&&(t+=A.padHex(Math.round(this.a*255).toString(16))),t}toRgbaString(t=3){const n=[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255)],i=Math.pow(10,t);return this.a!==1?(n.push(Math.round(this.a*i)/i),`rgba(${n.join(", ")})`):`rgb(${n.join(", ")})`}toString(){return this.a===1?this.toHexString():this.toRgbaString()}toHSB(){return A.RGBtoHSB(this.r,this.g,this.b)}static RGBtoOKLCH(t,n,i){const s=srgbToLinear(t),r=srgbToLinear(n),a=srgbToLinear(i),h=Math.cbrt(.4122214708*s+.5363325363*r+.0514459929*a),o=Math.cbrt(.2119034982*s+.6806995451*r+.1073969566*a),c=Math.cbrt(.0883024619*s+.2817188376*r+.6299787005*a),l=.2104542553*h+.793617785*o-.0040720468*c,u=1.9779984951*h-2.428592205*o+.4505937099*c,d=.0259040371*h+.7827717662*o-.808675766*c,f=Math.atan2(d,u)*180/Math.PI,p=l,m=Math.hypot(u,d),g=f>=0?f:f+360;return[p,m,g]}static OKLCHtoRGB(t,n,i){const s=t,r=n*Math.cos(i*Math.PI/180),a=n*Math.sin(i*Math.PI/180),h=(s+.3963377774*r+.2158037573*a)**3,o=(s-.1055613458*r-.0638541728*a)**3,c=(s-.0894841775*r-1.291485548*a)**3,l=4.0767416621*h-3.3077115913*o+.2309699292*c,u=-1.2684380046*h+2.6097574011*o-.3413193965*c,d=-.0041960863*h-.7034186147*o+1.707614701*c,f=srgbFromLinear(l),p=srgbFromLinear(u),m=srgbFromLinear(d);return[f,p,m]}static RGBtoHSL(t,n,i){const s=Math.min(t,n,i),r=Math.max(t,n,i),a=(r+s)/2;let h,o;if(r===s)h=0,o=0;else{const c=r-s;o=a>.5?c/(2-r-s):c/(r+s),r===t?h=(n-i)/c+(n<i?6:0):r===n?h=(i-t)/c+2:h=(t-n)/c+4,h*=360/6}return[h,o,a]}static HSLtoRGB(t,n,i){if(t=(t%360+360)%360,n===0)return[i,i,i];const s=i<.5?i*(1+n):i+n-i*n,r=2*i-s;function a(l){return l<0&&(l+=1),l>1&&(l-=1),l<1/6?r+(s-r)*6*l:l<1/2?s:l<2/3?r+(s-r)*(2/3-l)*6:r}const h=a(t/360+1/3),o=a(t/360),c=a(t/360-1/3);return[h,o,c]}static RGBtoHSB(t,n,i){const s=Math.min(t,n,i),r=Math.max(t,n,i),a=r===0?0:(r-s)/r;let h=0;if(s!==r){const o=r-s,c=(r-t)/o,l=(r-n)/o,u=(r-i)/o;t===r?h=u-l:n===r?h=2+c-u:h=4+l-c,h/=6,h<0&&(h=h+1)}return[h*360,a,r]}static HSBtoRGB(t,n,i){t=(t%360+360)%360/360;let s=0,r=0,a=0;if(n===0)s=r=a=i;else{const h=(t-Math.floor(t))*6,o=h-Math.floor(h),c=i*(1-n),l=i*(1-n*o),u=i*(1-n*(1-o));switch(h>>0){case 0:s=i,r=u,a=c;break;case 1:s=l,r=i,a=c;break;case 2:s=c,r=i,a=u;break;case 3:s=c,r=l,a=i;break;case 4:s=u,r=c,a=i;break;case 5:s=i,r=c,a=l;break}}return[s,r,a]}static mix(t,n,i){return new A(lerp(t.r,n.r,i),lerp(t.g,n.g,i),lerp(t.b,n.b,i),lerp(t.a,n.a,i))}};_Color.nameToHex=new Map([["aliceblue","#F0F8FF"],["antiquewhite","#FAEBD7"],["aqua","#00FFFF"],["aquamarine","#7FFFD4"],["azure","#F0FFFF"],["beige","#F5F5DC"],["bisque","#FFE4C4"],["black","#000000"],["blanchedalmond","#FFEBCD"],["blue","#0000FF"],["blueviolet","#8A2BE2"],["brown","#A52A2A"],["burlywood","#DEB887"],["cadetblue","#5F9EA0"],["chartreuse","#7FFF00"],["chocolate","#D2691E"],["coral","#FF7F50"],["cornflowerblue","#6495ED"],["cornsilk","#FFF8DC"],["crimson","#DC143C"],["cyan","#00FFFF"],["darkblue","#00008B"],["darkcyan","#008B8B"],["darkgoldenrod","#B8860B"],["darkgray","#A9A9A9"],["darkgreen","#006400"],["darkgrey","#A9A9A9"],["darkkhaki","#BDB76B"],["darkmagenta","#8B008B"],["darkolivegreen","#556B2F"],["darkorange","#FF8C00"],["darkorchid","#9932CC"],["darkred","#8B0000"],["darksalmon","#E9967A"],["darkseagreen","#8FBC8F"],["darkslateblue","#483D8B"],["darkslategray","#2F4F4F"],["darkslategrey","#2F4F4F"],["darkturquoise","#00CED1"],["darkviolet","#9400D3"],["deeppink","#FF1493"],["deepskyblue","#00BFFF"],["dimgray","#696969"],["dimgrey","#696969"],["dodgerblue","#1E90FF"],["firebrick","#B22222"],["floralwhite","#FFFAF0"],["forestgreen","#228B22"],["fuchsia","#FF00FF"],["gainsboro","#DCDCDC"],["ghostwhite","#F8F8FF"],["gold","#FFD700"],["goldenrod","#DAA520"],["gray","#808080"],["green","#008000"],["greenyellow","#ADFF2F"],["grey","#808080"],["honeydew","#F0FFF0"],["hotpink","#FF69B4"],["indianred","#CD5C5C"],["indigo","#4B0082"],["ivory","#FFFFF0"],["khaki","#F0E68C"],["lavender","#E6E6FA"],["lavenderblush","#FFF0F5"],["lawngreen","#7CFC00"],["lemonchiffon","#FFFACD"],["lightblue","#ADD8E6"],["lightcoral","#F08080"],["lightcyan","#E0FFFF"],["lightgoldenrodyellow","#FAFAD2"],["lightgray","#D3D3D3"],["lightgreen","#90EE90"],["lightgrey","#D3D3D3"],["lightpink","#FFB6C1"],["lightsalmon","#FFA07A"],["lightseagreen","#20B2AA"],["lightskyblue","#87CEFA"],["lightslategray","#778899"],["lightslategrey","#778899"],["lightsteelblue","#B0C4DE"],["lightyellow","#FFFFE0"],["lime","#00FF00"],["limegreen","#32CD32"],["linen","#FAF0E6"],["magenta","#FF00FF"],["maroon","#800000"],["mediumaquamarine","#66CDAA"],["mediumblue","#0000CD"],["mediumorchid","#BA55D3"],["mediumpurple","#9370DB"],["mediumseagreen","#3CB371"],["mediumslateblue","#7B68EE"],["mediumspringgreen","#00FA9A"],["mediumturquoise","#48D1CC"],["mediumvioletred","#C71585"],["midnightblue","#191970"],["mintcream","#F5FFFA"],["mistyrose","#FFE4E1"],["moccasin","#FFE4B5"],["navajowhite","#FFDEAD"],["navy","#000080"],["oldlace","#FDF5E6"],["olive","#808000"],["olivedrab","#6B8E23"],["orange","#FFA500"],["orangered","#FF4500"],["orchid","#DA70D6"],["palegoldenrod","#EEE8AA"],["palegreen","#98FB98"],["paleturquoise","#AFEEEE"],["palevioletred","#DB7093"],["papayawhip","#FFEFD5"],["peachpuff","#FFDAB9"],["peru","#CD853F"],["pink","#FFC0CB"],["plum","#DDA0DD"],["powderblue","#B0E0E6"],["purple","#800080"],["rebeccapurple","#663399"],["red","#FF0000"],["rosybrown","#BC8F8F"],["royalblue","#4169E1"],["saddlebrown","#8B4513"],["salmon","#FA8072"],["sandybrown","#F4A460"],["seagreen","#2E8B57"],["seashell","#FFF5EE"],["sienna","#A0522D"],["silver","#C0C0C0"],["skyblue","#87CEEB"],["slateblue","#6A5ACD"],["slategray","#708090"],["slategrey","#708090"],["snow","#FFFAFA"],["springgreen","#00FF7F"],["steelblue","#4682B4"],["tan","#D2B48C"],["teal","#008080"],["thistle","#D8BFD8"],["tomato","#FF6347"],["transparent","#00000000"],["turquoise","#40E0D0"],["violet","#EE82EE"],["wheat","#F5DEB3"],["white","#FFFFFF"],["whitesmoke","#F5F5F5"],["yellow","#FFFF00"],["yellowgreen","#9ACD32"]]);var Color=_Color,doOnceState=new Map;function doOnce(e,t){doOnceState.has(t)||(doOnceState.set(t,!0),e())}doOnce.clear=()=>doOnceState.clear();var Logger={log(...e){console.log(...e)},warn(e,...t){console.warn(`AG Charts - ${e}`,...t)},error(e,...t){typeof e=="object"?console.error("AG Charts error",e,...t):console.error(`AG Charts - ${e}`,...t)},table(...e){console.table(...e)},warnOnce(e,...t){doOnce(()=>Logger.warn(e,...t),`Logger.warn: ${e}`)},errorOnce(e,...t){doOnce(()=>Logger.error(e,...t),`Logger.error: ${e}`)}},Invalidating=(e,t)=>{const n=Symbol(String(t));e[n]=void 0,Object.defineProperty(e,t,{get(){return this[n]},set(i){this[n]!==i&&(this[n]=i,this.invalid=!0)},enumerable:!0,configurable:!1})},convertColorStringToOklcha=e=>{const t=Color.fromString(e),[n,i,s]=Color.RGBtoOKLCH(t.r,t.g,t.b);return{l:n,c:i,h:s,a:t.a}},delta=1e-6,isAchromatic=e=>e.c<delta||e.l<delta||e.l>1-delta,interpolateOklch=(e,t,n)=>{n=clamp(0,n,1);let i;if(isAchromatic(e))i=t.h;else if(isAchromatic(t))i=e.h;else{const h=e.h;let o=t.h;const c=t.h-e.h;c>180?o-=360:c<-180&&(o+=360),i=h*(1-n)+o*n}const s=e.c*(1-n)+t.c*n,r=e.l*(1-n)+t.l*n,a=e.a*(1-n)+t.a*n;return Color.fromOKLCH(r,s,i,a)},ColorScale=class{constructor(){this.type="color",this.invalid=!0,this.domain=[0,1],this.range=["red","blue"],this.parsedRange=this.range.map(convertColorStringToOklcha)}update(){const{domain:e,range:t}=this;e.length<2&&(Logger.warnOnce("`colorDomain` should have at least 2 values."),e.length===0?e.push(0,1):e.length===1&&e.push(e[0]+1));for(let n=1;n<e.length;n++){const i=e[n-1],s=e[n];if(i>=s){Logger.warnOnce("`colorDomain` values should be supplied in ascending order."),e.sort((r,a)=>r-a);break}}if(t.length<e.length)for(let n=t.length;n<e.length;n++)t.push(t.length>0?t[0]:"black");this.parsedRange=this.range.map(convertColorStringToOklcha)}convert(e){this.refresh();const{domain:t,range:n,parsedRange:i}=this,s=t[0],r=t.at(-1),a=n[0],h=n[n.length-1];if(e<=s)return a;if(e>=r)return h;let o,c;if(t.length===2){const d=(e-s)/(r-s),f=1/(n.length-1);o=n.length<=2?0:Math.min(Math.floor(d*(n.length-1)),n.length-2),c=(d-o*f)/f}else{for(o=0;o<t.length-2&&!(e<t[o+1]);o++);const d=t[o],f=t[o+1];c=(e-d)/(f-d)}const l=i[o],u=i[o+1];return interpolateOklch(l,u,c).toRgbaString()}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&Logger.warnOnce("Expected update to not invalidate scale"))}};__decorateClass([Invalidating],ColorScale.prototype,"domain",2),__decorateClass([Invalidating],ColorScale.prototype,"range",2);var Gradient=class{constructor(e,t=[],n){this.colorSpace=e,this.stops=t,this.bbox=n,this._cache=void 0}createGradient(e,t){const n=this.bbox??t;if(this._cache!=null&&this._cache.ctx===e&&this._cache.bbox.equals(n))return this._cache.gradient;const{stops:i,colorSpace:s}=this;if(i.length===0)return;if(i.length===1)return i[0].color;let r=this.createCanvasGradient(e,n);if(r==null)return;const a=s==="oklch",h=.05;let o=i[0];r.addColorStop(o.offset,o.color);for(let c=1;c<i.length;c+=1){const l=i[c];if(a){const u=new ColorScale;u.domain=[o.offset,l.offset],u.range=[o.color,l.color];for(let d=o.offset+h;d<l.offset;d+=h)r.addColorStop(d,u.convert(d))}r.addColorStop(l.offset,l.color),o=l}return"createPattern"in r&&(r=r.createPattern()),this._cache={ctx:e,bbox:n,gradient:r},r}},twoPi=Math.PI*2,halfPi=Math.PI/2;function normalizeAngle360(e){return e%=twoPi,e+=twoPi,e%=twoPi,e}function normalizeAngle180(e){return e%=twoPi,e<-Math.PI?e+=twoPi:e>=Math.PI&&(e-=twoPi),e}function isBetweenAngles(e,t,n){const i=normalizeAngle360(e),s=normalizeAngle360(t),r=normalizeAngle360(n);return s<r?s<=i&&i<=r:s>r?s<=i||i<=r:!0}function toRadians(e){return e/180*Math.PI}function angleBetween(e,t){return e=normalizeAngle360(e),t=normalizeAngle360(t),t-e+(e>t?twoPi:0)}var LinearGradient=class extends Gradient{constructor(e,t,n=0,i){super(e,t,i),this.angle=n}createCanvasGradient(e,t){const{angle:i}=this,s=normalizeAngle360(toRadians(i+90)),r=Math.cos(s),a=Math.sin(s),h=t.width,o=t.height,c=t.x+h*.5,l=t.y+o*.5,u=Math.sqrt(o*o+h*h)/2,d=Math.atan2(o,h);let f;s<Math.PI/2?f=s:s<Math.PI?f=Math.PI-s:s<1.5*Math.PI?f=s-Math.PI:f=2*Math.PI-s;const p=u*Math.abs(Math.cos(f-d));return e.createLinearGradient(c+r*p,l+a*p,c-r*p,l-a*p)}},LINEAR_GRADIENT_REGEXP=/^linear-gradient\((-?[\d.]+)deg,(.*?)\)$/i,_Shape=class O extends Node{constructor(){super(...arguments),this.fillOpacity=1,this.strokeOpacity=1,this.fill=O.defaultStyles.fill,this.stroke=O.defaultStyles.stroke,this.strokeWidth=O.defaultStyles.strokeWidth,this.lineDash=O.defaultStyles.lineDash,this.lineDashOffset=O.defaultStyles.lineDashOffset,this.lineCap=O.defaultStyles.lineCap,this.lineJoin=O.defaultStyles.lineJoin,this.miterLimit=void 0,this.opacity=O.defaultStyles.opacity,this.fillShadow=O.defaultStyles.fillShadow}restoreOwnStyles(){const{defaultStyles:t}=this.constructor;Object.assign(this,t)}getGradient(t){let n;if(t instanceof Gradient)return t;if(t?.startsWith("linear-gradient")&&(n=LINEAR_GRADIENT_REGEXP.exec(t))){const i=parseFloat(n[1]),s=[],r=n[2],a=/(#[0-9a-f]+)|(rgba?\(.+?\))|([a-z]+)/gi;let h;for(;h=a.exec(r);)s.push(h[0]);return new LinearGradient("rgb",s.map((o,c)=>({color:o,offset:c/(s.length-1)})),i)}else return}onFillChange(){this.fillGradient=this.getGradient(this.fill)}onStrokeChange(){this.strokeGradient=this.getGradient(this.stroke)}align(t,n){const i=this.layerManager?.canvas?.pixelRatio??1,s=Math.round(t*i)/i;return n==null?s:n===0?0:n<1?Math.ceil(n*i)/i:Math.round((n+t)*i)/i-s}fillStroke(t,n){this.renderFill(t,n),this.renderStroke(t,n)}renderFill(t,n){if(this.fill){const{globalAlpha:i}=t;this.applyFill(t),this.applyFillAlpha(t),this.applyShadow(t),this.executeFill(t,n),t.globalAlpha=i}t.shadowColor="rgba(0, 0, 0, 0)"}executeFill(t,n){n?t.fill(n):t.fill()}applyFill(t){t.fillStyle=this.fillGradient?.createGradient(t,this.getBBox())??(typeof this.fill=="string"?this.fill:void 0)??"black"}applyStroke(t){t.strokeStyle=this.strokeGradient?.createGradient(t,this.getBBox())??(typeof this.stroke=="string"?this.stroke:void 0)??"black"}applyFillAlpha(t){t.globalAlpha*=this.opacity*this.fillOpacity}applyShadow(t){const n=this.layerManager?.canvas.pixelRatio??1,i=this.fillShadow;i?.enabled&&(t.shadowColor=i.color,t.shadowOffsetX=i.xOffset*n,t.shadowOffsetY=i.yOffset*n,t.shadowBlur=i.blur*n)}renderStroke(t,n){if(this.stroke&&this.strokeWidth){const{globalAlpha:i}=t;this.applyStroke(t),t.globalAlpha*=this.opacity*this.strokeOpacity,t.lineWidth=this.strokeWidth,this.lineDash&&t.setLineDash(this.lineDash),this.lineDashOffset&&(t.lineDashOffset=this.lineDashOffset),this.lineCap&&(t.lineCap=this.lineCap),this.lineJoin&&(t.lineJoin=this.lineJoin),this.miterLimit!=null&&(t.miterLimit=this.miterLimit),this.executeStroke(t,n),t.globalAlpha=i}}executeStroke(t,n){n?t.stroke(n):t.stroke()}containsPoint(t,n){return this.isPointInPath(t,n)}applySvgFillAttributes(t){t.setAttribute("fill",typeof this.fill=="string"?this.fill:"none"),t.setAttribute("fill-opacity",String(this.fillOpacity))}applySvgStrokeAttributes(t){this.stroke!=null&&(t.setAttribute("stroke",typeof this.stroke=="string"?this.stroke:"none"),t.setAttribute("stroke-opacity",String(this.strokeOpacity)),t.setAttribute("stroke-width",String(this.strokeWidth))),this.lineDash!=null&&t.setAttribute("stroke-dasharray",this.lineDash.join(" "))}};_Shape.defaultStyles={fill:"black",stroke:void 0,strokeWidth:0,lineDash:void 0,lineDashOffset:0,lineCap:void 0,lineJoin:void 0,opacity:1,fillShadow:void 0},__decorateClass([SceneChangeDetection()],_Shape.prototype,"fillOpacity",2),__decorateClass([SceneChangeDetection()],_Shape.prototype,"strokeOpacity",2),__decorateClass([SceneChangeDetection({changeCb:e=>e.onFillChange()})],_Shape.prototype,"fill",2),__decorateClass([SceneChangeDetection({changeCb:e=>e.onStrokeChange()})],_Shape.prototype,"stroke",2),__decorateClass([SceneChangeDetection()],_Shape.prototype,"strokeWidth",2),__decorateClass([SceneChangeDetection()],_Shape.prototype,"lineDash",2),__decorateClass([SceneChangeDetection()],_Shape.prototype,"lineDashOffset",2),__decorateClass([SceneChangeDetection()],_Shape.prototype,"lineCap",2),__decorateClass([SceneChangeDetection()],_Shape.prototype,"lineJoin",2),__decorateClass([SceneChangeDetection()],_Shape.prototype,"miterLimit",2),__decorateClass([SceneChangeDetection({convertor:e=>clamp(0,e,1)})],_Shape.prototype,"opacity",2),__decorateClass([SceneChangeDetection({checkDirtyOnAssignment:!0})],_Shape.prototype,"fillShadow",2);var Shape=_Shape,_Text=class z extends Shape{constructor(){super(...arguments),this.x=0,this.y=0,this.lines=[],this.text=void 0,this.fontSize=10,this.fontFamily="sans-serif",this.textAlign=z.defaultStyles.textAlign,this.textBaseline=z.defaultStyles.textBaseline}onTextChange(){this.lines=this.text?.split(`
`).map(t=>t.trim())??[]}static computeBBox(t,n,i,s){const{offsetTop:r,offsetLeft:a,width:h,height:o}=CachedTextMeasurerPool.measureLines(t,s);return new BBox(n-a,i-r,h,o)}computeBBox(){const{x:t,y:n,lines:i,textBaseline:s,textAlign:r}=this;return z.computeBBox(i,t,n,{font:this,textBaseline:s,textAlign:r})}isPointInPath(t,n){const i=this.getBBox();return i?i.containsPoint(t,n):!1}render(t){const{ctx:n,stats:i}=t;if(!this.lines.length||!this.layerManager)return i&&(i.nodesSkipped+=1),super.render(t);const{fill:s,stroke:r,strokeWidth:a}=this,{pixelRatio:h}=this.layerManager.canvas;if(n.font=TextUtils.toFontString(this),n.textAlign=this.textAlign,n.textBaseline=this.textBaseline,s){this.applyFill(n),n.globalAlpha*=this.opacity*this.fillOpacity;const{fillShadow:o}=this;o?.enabled&&(n.shadowColor=o.color,n.shadowOffsetX=o.xOffset*h,n.shadowOffsetY=o.yOffset*h,n.shadowBlur=o.blur*h),this.renderLines((c,l,u)=>n.fillText(c,l,u))}if(r&&a){this.applyStroke(n),n.lineWidth=a,n.globalAlpha*=this.opacity*this.strokeOpacity;const{lineDash:o,lineDashOffset:c,lineCap:l,lineJoin:u}=this;o&&n.setLineDash(o),c&&(n.lineDashOffset=c),l&&(n.lineCap=l),u&&(n.lineJoin=u),this.renderLines((d,f,p)=>n.strokeText(d,f,p))}super.render(t)}renderLines(t){const{lines:n,x:i,y:s}=this,r=this.lineHeight??TextUtils.getLineHeight(this.fontSize);let a=(r-r*n.length)*TextUtils.getVerticalModifier(this.textBaseline);for(const h of n)t(h,i,s+a),a+=r}setFont(t){this.fontFamily=t.fontFamily,this.fontSize=t.fontSize,this.fontStyle=t.fontStyle,this.fontWeight=t.fontWeight}setAlign(t){this.textAlign=t.textAlign,this.textBaseline=t.textBaseline}toSVG(){if(!this.visible||!this.text)return;const t=document.createElementNS("http://www.w3.org/2000/svg","text");return this.applySvgFillAttributes(t),t.setAttribute("font-family",this.fontFamily?.split(",")[0]??""),t.setAttribute("font-size",String(this.fontSize)),t.setAttribute("font-style",this.fontStyle??""),t.setAttribute("font-weight",String(this.fontWeight??"")),t.setAttribute("text-anchor",{center:"middle",left:"start",right:"end",start:"start",end:"end"}[this.textAlign??"start"]),t.setAttribute("alignment-baseline",{alphabetic:"alphabetic",top:"top",bottom:"bottom",hanging:"hanging",middle:"middle",ideographic:"ideographic"}[this.textBaseline??"alphabetic"]),t.setAttribute("x",String(this.x)),t.setAttribute("y",String(this.y)),t.textContent=this.text??"",{elements:[t]}}};_Text.className="Text",_Text.defaultStyles={...Shape.defaultStyles,textAlign:"start",fontStyle:void 0,fontWeight:void 0,fontSize:10,fontFamily:"sans-serif",textBaseline:"alphabetic"},__decorateClass([SceneChangeDetection()],_Text.prototype,"x",2),__decorateClass([SceneChangeDetection()],_Text.prototype,"y",2),__decorateClass([SceneChangeDetection({changeCb:e=>e.onTextChange()})],_Text.prototype,"text",2),__decorateClass([SceneChangeDetection()],_Text.prototype,"fontStyle",2),__decorateClass([SceneChangeDetection()],_Text.prototype,"fontWeight",2),__decorateClass([SceneChangeDetection()],_Text.prototype,"fontSize",2),__decorateClass([SceneChangeDetection()],_Text.prototype,"fontFamily",2),__decorateClass([SceneChangeDetection()],_Text.prototype,"textAlign",2),__decorateClass([SceneChangeDetection()],_Text.prototype,"textBaseline",2),__decorateClass([SceneChangeDetection()],_Text.prototype,"lineHeight",2);var Text=_Text,RotatableText=class extends Rotatable(Text){},TransformableText=class extends Rotatable(Translatable(Text)){},BREAK_TRANSFORM_CHAIN=Symbol("BREAK"),CONFIG_KEY="__decorator_config";function initialiseConfig(e,t){Object.getOwnPropertyDescriptor(e,CONFIG_KEY)==null&&Object.defineProperty(e,CONFIG_KEY,{value:{}});const n=e[CONFIG_KEY],i=t.toString();if(typeof n[i]<"u")return n[i];const s=new WeakMap;n[i]={setters:[],getters:[],observers:[],valuesMap:s};const r=Object.getOwnPropertyDescriptor(e,t),a=r?.set,h=r?.get;return Object.defineProperty(e,t,{set:function(l){const{setters:u,observers:d}=n[i];let f;u.some(p=>p.length>2)&&(f=h?h.call(this):s.get(this));for(const p of u)if(l=p(this,t,l,f),l===BREAK_TRANSFORM_CHAIN)return;a?a.call(this,l):s.set(this,l);for(const p of d)p(this,l,f)},get:function(){let l=h?h.call(this):s.get(this);for(const u of n[i].getters)if(l=u(this,t,l),l===BREAK_TRANSFORM_CHAIN)return;return l},enumerable:!0,configurable:!1}),n[i]}function addTransformToInstanceProperty(e,t,n){return(i,s)=>{const r=initialiseConfig(i,s);r.setters.push(e),t&&r.getters.unshift(t),n&&Object.assign(r,n)}}function addObserverToInstanceProperty(e){return(t,n)=>{initialiseConfig(t,n).observers.push(e)}}function isDecoratedObject(e){return typeof e<"u"&&CONFIG_KEY in e}function listDecoratedProperties(e){const t=new Set;for(;isDecoratedObject(e);)t.add(e?.[CONFIG_KEY]),e=Object.getPrototypeOf(e);return Array.from(t).flatMap(n=>Object.keys(n))}function extractDecoratedPropertyMetadata(e,t){const n=t.toString();for(;isDecoratedObject(e);){const i=e[CONFIG_KEY];if(Object.hasOwn(i,n))return i[n];e=Object.getPrototypeOf(e)}}function isArray(e){return Array.isArray(e)}function isBoolean(e){return typeof e=="boolean"}function isDate(e){return e instanceof Date}function isValidDate(e){return isDate(e)&&!isNaN(Number(e))}function isFunction(e){return typeof e=="function"}function isObject(e){return typeof e=="object"&&e!==null&&!isArray(e)}function isString(e){return typeof e=="string"}function isNumber(e){return typeof e=="number"}function isFiniteNumber(e){return Number.isFinite(e)}var BaseProperties=class{set(e){const{className:t=this.constructor.name}=this.constructor;if(typeof e!="object")return Logger.warn(`unable to set ${t} - expecting a properties object`),this;const n=new Set(Object.keys(e));for(const i of listDecoratedProperties(this))if(n.has(i)){const s=e[i],r=this;if(isProperties(r[i]))if(r[i]instanceof PropertiesArray){const a=r[i].reset(s);a!=null?r[i]=a:Logger.warn(`unable to set [${i}] - expecting a properties array`)}else r[i].set(s);else r[i]=s;n.delete(i)}for(const i of n)Logger.warn(`unable to set [${i}] in ${t} - property is unknown`);return this}isValid(e){return listDecoratedProperties(this).every(t=>{const{optional:n}=extractDecoratedPropertyMetadata(this,t),i=n===!0||typeof this[t]<"u";return i||Logger.warnOnce(`${e??""}[${t}] is required.`),i})}toJson(){return listDecoratedProperties(this).reduce((e,t)=>{const n=this[t];return e[t]=isProperties(n)?n.toJson():n,e},{})}},PropertiesArray=class st extends Array{constructor(t,...n){super(n.length);const s=(r=>!!r?.prototype?.constructor?.name)(t)?r=>new t().set(r):t;Object.defineProperty(this,"itemFactory",{value:s,enumerable:!1,configurable:!1}),this.set(n)}set(t){if(isArray(t)){this.length=t.length;for(let n=0;n<t.length;n++)this[n]=this.itemFactory(t[n])}return this}reset(t){if(Array.isArray(t))return new st(this.itemFactory,...t)}toJson(){return this.map(t=>t?.toJson?.()??t)}};function isProperties(e){return e instanceof BaseProperties||e instanceof PropertiesArray}function ProxyPropertyOnWrite(e,t){return addTransformToInstanceProperty((n,i,s)=>n[e][t??i]=s)}function ObserveChanges(e){return addObserverToInstanceProperty(e)}var TextWrapper=class{static wrapText(e,t){return this.wrapLines(e,t).join(`
`)}static wrapLines(e,t){const n=this.textWrap(e,t);return t.overflow==="hide"&&n.some(i=>i.endsWith(TextUtils.EllipsisChar))?[]:n}static appendEllipsis(e){return e.replace(/[.,]{1,5}$/,"")+TextUtils.EllipsisChar}static truncateLine(e,t,n,i){const s=t.textWidth(TextUtils.EllipsisChar);let r=0,a=0;for(;a<e.length;a++){const h=t.textWidth(e.charAt(a));if(r+h>n)break;r+=h}if(e.length===a&&(!i||r+s<=n))return i?e+TextUtils.EllipsisChar:e;for(e=e.slice(0,a).trimEnd();e.length&&t.textWidth(e)+s>n;)e=e.slice(0,-1).trimEnd();return e+TextUtils.EllipsisChar}static textWrap(e,t){const n=e.split(TextUtils.lineSplitter),i=CachedTextMeasurerPool.getMeasurer(t);if(t.textWrap==="never")return n.map(h=>this.truncateLine(h.trimEnd(),i,t.maxWidth));const s=[],r=t.textWrap==="hyphenate",a=t.textWrap==null||t.textWrap==="on-space";for(const h of n){let o=h.trimEnd();if(o===""){s.push(o);continue}for(let c=0,l=0,u=0;c<o.length;c++){const d=o.charAt(c);if(l+=i.textWidth(d),d===" "&&(u=c),l>t.maxWidth){if(c===0)break;const f=i.textWidth(o.slice(0,c+1));if(f<=t.maxWidth){l=f;continue}if(u){const g=this.getWordAt(o,u+1),y=i.textWidth(g);if(y<=t.maxWidth){s.push(o.slice(0,u).trimEnd()),o=o.slice(u).trimStart(),c=-1,l=0,u=0;continue}else a&&y>t.maxWidth&&s.push(o.slice(0,u).trimEnd(),this.truncateLine(o.slice(u).trimStart(),i,t.maxWidth,!0))}else a&&s.push(this.truncateLine(o,i,t.maxWidth,!0));if(a){o="";break}const p=r?"-":"";let m=o.slice(0,c).trim();for(;m.length&&i.textWidth(m+p)>t.maxWidth;)m=m.slice(0,-1).trimEnd();if(s.push(m+p),!m.length){o="";break}o=o.slice(m.length).trimStart(),c=-1,l=0,u=0}}o&&s.push(o)}return this.avoidOrphans(s,i,t),this.clipLines(s,i,t)}static getWordAt(e,t){const n=e.indexOf(" ",t);return n===-1?e.slice(t):e.slice(t,n)}static clipLines(e,t,n){if(!n.maxHeight)return e;const{height:i,lineMetrics:s}=t.measureLines(e);if(i<=n.maxHeight)return e;for(let r=0,a=0;r<s.length;r++){const{lineHeight:h}=s[r];if(a+=h,a>n.maxHeight){if(n.overflow==="hide")return[];const o=e.slice(0,r||1),c=o.pop();return o.concat(this.truncateLine(c,t,n.maxWidth,!0))}}return e}static avoidOrphans(e,t,n){if(n.avoidOrphans===!1||e.length<2)return;const{length:i}=e,s=e[i-1],r=e[i-2];if(r.length<s.length)return;const a=r.lastIndexOf(" ");if(a===-1||a===r.indexOf(" ")||s.includes(" "))return;const h=r.slice(a+1);t.textWidth(s+h)<=n.maxWidth&&(e[i-2]=r.slice(0,a),e[i-1]=h+" "+s)}};function Validate(e,t={}){const{optional:n=!1,property:i}=t;return addTransformToInstanceProperty((s,r,a)=>{const h={...t,target:s,property:r};if(n&&typeof a>"u"||e(a,h))return isProperties(s[r])&&!isProperties(a)?(s[r].set(a),s[r]):a;const o=i??String(r).replace(/^_*/,""),c=s.constructor.className??s.constructor.name.replace(/Properties$/,"");let l=stringify(a);const u=50;if(l!=null&&l.length>u){const d=l.length-u;l=l.slice(0,u)+`... (+${d} characters)`}return Logger.warn(`Property [${o}] of [${c}] cannot be set to [${l}]${e.message?`; expecting ${getPredicateMessage(e,h)}`:""}, ignoring.`),BREAK_TRANSFORM_CHAIN},void 0,{optional:n})}var AND=(...e)=>{const t=[];return predicateWithMessage((n,i)=>(t.length=0,e.every(s=>{const r=s(n,i);return r||t.push(getPredicateMessage(s,i)),r})),()=>t.filter(Boolean).join(" AND "))},OR=(...e)=>predicateWithMessage((t,n)=>e.some(i=>i(t,n)),t=>e.map(getPredicateMessageMapper(t)).filter(Boolean).join(" OR ")),OBJECT=attachObjectRestrictions(predicateWithMessage((e,t)=>isProperties(e)||isObject(e)&&isProperties(t.target[t.property]),"a properties object")),PLAIN_OBJECT=attachObjectRestrictions(predicateWithMessage(e=>isObject(e),"an object")),BOOLEAN=predicateWithMessage(isBoolean,"a boolean"),FUNCTION=predicateWithMessage(isFunction,"a function"),STRING=predicateWithMessage(isString,"a string"),NUMBER=attachNumberRestrictions(predicateWithMessage(isFiniteNumber,"a number")),REAL_NUMBER=predicateWithMessage(e=>isNumber(e)&&!isNaN(e),"a real number"),NAN=predicateWithMessage(e=>isNumber(e)&&isNaN(e),"NaN"),POSITIVE_NUMBER=NUMBER.restrict({min:0}),RATIO=NUMBER.restrict({min:0,max:1}),NUMBER_OR_NAN=OR(NUMBER,NAN),ARRAY=attachArrayRestrictions(predicateWithMessage(isArray,"an array")),ARRAY_OF=(e,t)=>predicateWithMessage((n,i)=>isArray(n)&&n.every(s=>e(s,i)),n=>{const i=getPredicateMessage(ARRAY,n)??"";return typeof t=="function"?`${i} of ${t(n)}`:t?`${i} of ${t}`:i}),isComparable=e=>isFiniteNumber(e)||isValidDate(e),LESS_THAN=e=>predicateWithMessage((t,n)=>!isComparable(t)||!isComparable(n.target[e])||t<n.target[e],`to be less than ${e}`),GREATER_THAN=e=>predicateWithMessage((t,n)=>!isComparable(t)||!isComparable(n.target[e])||t>n.target[e],`to be greater than ${e}`),DATE=predicateWithMessage(isValidDate,"Date object"),DATE_OR_DATETIME_MS=OR(DATE,POSITIVE_NUMBER),colorMessage="A color string can be in one of the following formats to be valid: #rgb, #rrggbb, rgb(r, g, b), rgba(r, g, b, a) or a CSS color name such as 'white', 'orange', 'cyan', etc",COLOR_STRING=predicateWithMessage(e=>isString(e)&&Color.validColorString(e),`color String. ${colorMessage}`),COLOR_STRING_ARRAY=predicateWithMessage(ARRAY_OF(COLOR_STRING),`color strings. ${colorMessage}`),BOOLEAN_ARRAY=ARRAY_OF(BOOLEAN,"boolean values"),NUMBER_ARRAY=ARRAY_OF(NUMBER,"numbers"),STRING_ARRAY=ARRAY_OF(STRING,"strings"),DATE_ARRAY=predicateWithMessage(ARRAY_OF(DATE),"Date objects"),OBJECT_ARRAY=predicateWithMessage(ARRAY_OF(OBJECT),"objects"),LINE_CAP=UNION(["butt","round","square"],"a line cap"),LINE_JOIN=UNION(["round","bevel","miter"],"a line join"),LINE_STYLE=UNION(["solid","dashed","dotted"],"a line style"),LINE_DASH=predicateWithMessage(ARRAY_OF(POSITIVE_NUMBER),"numbers specifying the length in pixels of alternating dashes and gaps, for example, [6, 3] means dashes with a length of 6 pixels with gaps between of 3 pixels."),POSITION=UNION(["top","right","bottom","left"],"a position"),FONT_STYLE=UNION(["normal","italic","oblique"],"a font style"),FONT_WEIGHT=OR(UNION(["normal","bold","bolder","lighter"],"a font weight"),NUMBER.restrict({min:1,max:1e3})),TEXT_WRAP=UNION(["never","always","hyphenate","on-space"],"a text wrap strategy"),TEXT_ALIGN=UNION(["left","center","right"],"a text align"),VERTICAL_ALIGN=UNION(["top","middle","bottom"],"a vertical align"),OVERFLOW_STRATEGY=UNION(["ellipsis","hide"],"an overflow strategy"),DIRECTION=UNION(["horizontal","vertical"],"a direction"),PLACEMENT=UNION(["inside","outside"],"a placement"),INTERACTION_RANGE=OR(UNION(["exact","nearest"],"interaction range"),NUMBER),LABEL_PLACEMENT=UNION(["top","bottom","left","right"]);function UNION(e,t="a"){return predicateWithMessage((n,i)=>{const s=e.find(r=>{const a=typeof r=="string"?r:r.value;return n===a});if(s==null)return!1;if(typeof s!="string"&&(s.deprecated===!0||s.deprecatedTo!=null)){const r=[`Property [%s] with value '${s.value}' is deprecated.`];s.deprecatedTo&&r.push(`Use ${s.deprecatedTo} instead.`),Logger.warnOnce(r.join(" "),i.property)}return!0},`${t} keyword such as ${joinUnionOptions(e)}`)}var MIN_SPACING=OR(AND(NUMBER.restrict({min:1}),LESS_THAN("maxSpacing")),NAN),MAX_SPACING=OR(AND(NUMBER.restrict({min:1}),GREATER_THAN("minSpacing")),NAN);function predicateWithMessage(e,t){return e.message=t,e}function joinUnionOptions(e){const t=e.filter(i=>typeof i=="string"||i.undocumented!==!0).map(i=>`'${typeof i=="string"?i:i.value}'`);if(t.length===1)return t[0];const n=t.pop();return`${t.join(", ")} or ${n}`}function getPredicateMessage(e,t){return isFunction(e.message)?e.message(t):e.message}function getPredicateMessageMapper(e){return t=>getPredicateMessage(t,e)}function attachArrayRestrictions(e){return Object.assign(e,{restrict({length:t,minLength:n}={}){let i="an array";return isNumber(n)&&n>0?i="a non-empty array":isNumber(t)&&(i=`an array of length ${t}`),predicateWithMessage(s=>isArray(s)&&(isNumber(t)?s.length===t:!0)&&(isNumber(n)?s.length>=n:!0),i)}})}function attachNumberRestrictions(e){return Object.assign(e,{restrict({min:t,max:n}={}){const i=["a number"],s=isNumber(t),r=isNumber(n);return s&&r?i.push(`between ${t} and ${n} inclusive`):s?i.push(`greater than or equal to ${t}`):r&&i.push(`less than or equal to ${n}`),predicateWithMessage(a=>isFiniteNumber(a)&&(s?a>=t:!0)&&(r?a<=n:!0),i.join(" "))}})}function attachObjectRestrictions(e){return Object.assign(e,{restrict(t){return predicateWithMessage(n=>n instanceof t,n=>getPredicateMessage(e,n)??`an instance of ${t.name}`)}})}function stringify(e){if(typeof e=="number"){if(isNaN(e))return"NaN";if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity"}return JSON.stringify(e)}var Caption=class extends BaseProperties{constructor(){super(...arguments),this.id=createId(this),this.node=new RotatableText({zIndex:1}).setProperties({textAlign:"center",pointerEvents:1}),this.enabled=!1,this.textAlign="center",this.fontSize=10,this.fontFamily="sans-serif",this.wrapping="always",this.padding=0,this.layoutStyle="block",this.truncated=!1}registerInteraction(e,t){return e.layoutManager.addListener("layout:complete",()=>this.updateA11yText(e,t))}computeTextWrap(e,t){const{text:n,padding:i,wrapping:s}=this,r=Math.min(this.maxWidth??1/0,e)-i*2,a=this.maxHeight??t-i*2;if(!isFinite(r)&&!isFinite(a)){this.node.text=n;return}const h=TextWrapper.wrapText(n??"",{maxWidth:r,maxHeight:a,font:this,textWrap:s});this.node.text=h,this.truncated=h.includes(TextUtils.EllipsisChar)}updateA11yText(e,t){const{proxyInteractionService:n}=e;if(this.enabled&&this.text){const i=Transformable.toCanvas(this.node);if(i){const{id:s}=this;this.proxyText??(this.proxyText=n.createProxyElement({type:"text",domManagerId:s,where:t})),this.proxyText.textContent=this.text,this.proxyText.setBounds(i),this.proxyText.addListener("mousemove",r=>this.handleMouseMove(e,r)),this.proxyText.addListener("mouseleave",r=>this.handleMouseLeave(e,r))}}else this.proxyText?.destroy(),this.proxyText=void 0}handleMouseMove(e,t){if(t!=null&&this.enabled&&this.node.visible&&this.truncated){const{x:n,y:i}=Transformable.toCanvas(this.node),s=t.sourceEvent.offsetX+n,r=t.sourceEvent.offsetY+i,a={type:"hover",canvasX:s,canvasY:r};e.tooltipManager.updateTooltip(this.id,{canvasX:s,canvasY:r,lastPointerEvent:a,showArrow:!1},{title:this.text})}}handleMouseLeave(e,t){e.tooltipManager.removeTooltip(this.id)}};Caption.SMALL_PADDING=10,Caption.LARGE_PADDING=20,__decorateClass([Validate(BOOLEAN),ProxyPropertyOnWrite("node","visible")],Caption.prototype,"enabled",2),__decorateClass([Validate(STRING,{optional:!0}),ProxyPropertyOnWrite("node")],Caption.prototype,"text",2),__decorateClass([Validate(TEXT_ALIGN,{optional:!0}),ProxyPropertyOnWrite("node")],Caption.prototype,"textAlign",2),__decorateClass([Validate(FONT_STYLE,{optional:!0}),ProxyPropertyOnWrite("node")],Caption.prototype,"fontStyle",2),__decorateClass([Validate(FONT_WEIGHT,{optional:!0}),ProxyPropertyOnWrite("node")],Caption.prototype,"fontWeight",2),__decorateClass([Validate(POSITIVE_NUMBER),ProxyPropertyOnWrite("node")],Caption.prototype,"fontSize",2),__decorateClass([Validate(STRING),ProxyPropertyOnWrite("node")],Caption.prototype,"fontFamily",2),__decorateClass([Validate(COLOR_STRING,{optional:!0}),ProxyPropertyOnWrite("node","fill")],Caption.prototype,"color",2),__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],Caption.prototype,"spacing",2),__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],Caption.prototype,"maxWidth",2),__decorateClass([Validate(POSITIVE_NUMBER,{optional:!0})],Caption.prototype,"maxHeight",2),__decorateClass([Validate(TEXT_WRAP)],Caption.prototype,"wrapping",2),__decorateClass([Validate(POSITIVE_NUMBER)],Caption.prototype,"padding",2),__decorateClass([Validate(STRING)],Caption.prototype,"layoutStyle",2);function pointsDistanceSquared(e,t,n,i){const s=e-n,r=t-i;return s*s+r*r}function lineDistanceSquared(e,t,n,i,s,r,a){if(n===s&&i===r)return Math.min(a,pointsDistanceSquared(e,t,n,i));const h=s-n,o=r-i,c=Math.max(0,Math.min(1,((e-n)*h+(t-i)*o)/(h*h+o*o))),l=n+c*h,u=i+c*o;return Math.min(a,pointsDistanceSquared(e,t,l,u))}function arcDistanceSquared(e,t,n,i,s,r,a,h,o){h&&([a,r]=[r,a]);const c=Math.atan2(t-i,e-n);if(!isBetweenAngles(c,r,a)){const u=n+Math.cos(r)*s,d=i+Math.sin(r)*s,f=n+Math.cos(r)*s,p=i+Math.sin(r)*s;return Math.min(o,pointsDistanceSquared(e,t,u,d),pointsDistanceSquared(e,t,f,p))}const l=s-Math.sqrt(pointsDistanceSquared(e,t,n,i));return Math.min(o,l*l)}function linearRoot(e,t){const n=-t/e;return e!==0&&n>=0&&n<=1?[n]:[]}function quadraticRoots(e,t,n){if(e===0)return linearRoot(t,n);const i=t*t-4*e*n,s=[];if(i===0){const r=-t/(2*e);r>=0&&r<=1&&s.push(r)}else if(i>0){const r=Math.sqrt(i),a=(-t-r)/(2*e),h=(-t+r)/(2*e);a>=0&&a<=1&&s.push(a),h>=0&&h<=1&&s.push(h)}return s}function cubicRoots(e,t,n,i){if(e===0)return quadraticRoots(t,n,i);const s=t/e,r=n/e,a=i/e,h=(3*r-s*s)/9,o=(9*s*r-27*a-2*s*s*s)/54,c=h*h*h+o*o,l=1/3,u=[];if(c>=0){const d=Math.sqrt(c),f=Math.sign(o+d)*Math.pow(Math.abs(o+d),l),p=Math.sign(o-d)*Math.pow(Math.abs(o-d),l),m=Math.abs(Math.sqrt(3)*(f-p)/2),g=-l*s+(f+p);if(g>=0&&g<=1&&u.push(g),m===0){const y=-l*s-(f+p)/2;y>=0&&y<=1&&u.push(y)}}else{const d=Math.acos(o/Math.sqrt(-h*h*h)),f=l*s,p=2*Math.sqrt(-h),m=p*Math.cos(l*d)-f,g=p*Math.cos(l*(d+2*Math.PI))-f,y=p*Math.cos(l*(d+4*Math.PI))-f;m>=0&&m<=1&&u.push(m),g>=0&&g<=1&&u.push(g),y>=0&&y<=1&&u.push(y)}return u}function segmentIntersection(e,t,n,i,s,r,a,h){const o=(n-e)*(h-r)-(i-t)*(a-s);if(o===0)return 0;const c=((a-s)*(t-r)-(e-s)*(h-r))/o,l=((n-e)*(t-r)-(i-t)*(e-s))/o;return c>=0&&c<=1&&l>=0&&l<=1?1:0}function cubicSegmentIntersections(e,t,n,i,s,r,a,h,o,c,l,u){let d=0;const f=c-u,p=l-o,m=o*(u-c)-c*(l-o),g=bezierCoefficients(e,n,s,a),y=bezierCoefficients(t,i,r,h),M=f*g[0]+p*y[0],v=f*g[1]+p*y[1],R=f*g[2]+p*y[2],w=f*g[3]+p*y[3]+m,P=cubicRoots(M,v,R,w);for(const x of P){const b=x*x,C=x*b,S=g[0]*C+g[1]*b+g[2]*x+g[3],N=y[0]*C+y[1]*b+y[2]*x+y[3];let D;o===l?D=(N-c)/(u-c):D=(S-o)/(l-o),D>=0&&D<=1&&d++}return d}function bezierCoefficients(e,t,n,i){return[-e+3*t-3*n+i,3*e-6*t+3*n,-3*e+3*t,e]}function arcIntersections(e,t,n,i,s,r,a,h,o,c){if(isNaN(e)||isNaN(t))return 0;r&&([s,i]=[i,s]);const l=(c-h)/(o-a),u=h-l*a,d=Math.pow(l,2)+1,f=2*(l*(u-t)-e),p=Math.pow(e,2)+Math.pow(u-t,2)-Math.pow(n,2),m=Math.pow(f,2)-4*d*p;if(m<0)return 0;const g=(-f+Math.sqrt(m))/2/d,y=(-f-Math.sqrt(m))/2/d;let M=0;return[g,y].forEach(v=>{if(!(v>=Math.min(a,o)&&v<=Math.max(a,o)))return;const w=l*v+u,P=v-e,x=w-t,b=Math.atan2(x,P);isBetweenAngles(b,i,s)&&M++}),M}function evaluateBezier(e,t,n,i,s){return(1-s)**3*e+3*(1-s)**2*s*t+3*(1-s)*s**2*n+s**3*i}function calculateDerivativeExtrema(e,t,n,i){const s=-e+3*t-3*n+i,r=3*e-6*t+3*n,a=-3*e+3*t;if(s===0){if(r!==0){const o=-a/r;if(o>0&&o<1)return[o]}return[]}const h=r*r-4*s*a;if(h>=0){const o=Math.sqrt(h),c=(-r+o)/(2*s),l=(-r-o)/(2*s);return[c,l].filter(u=>u>0&&u<1)}return[]}function calculateDerivativeExtremaXY(e,t,n,i,s,r,a,h){const o=calculateDerivativeExtrema(e,n,s,a),c=calculateDerivativeExtrema(t,i,r,h);return[...o,...c]}var ExtendedPath2D=class{constructor(){this.path2d=new Path2D,this.previousCommands=[],this.previousParams=[],this.previousClosedPath=!1,this.commands=[],this.params=[],this.openedPath=!1,this.closedPath=!1}isEmpty(){return this.commands.length===0}isDirty(){return this.closedPath!==this.previousClosedPath||this.previousCommands.length!==this.commands.length||this.previousParams.length!==this.params.length||this.previousCommands.toString()!==this.commands.toString()||this.previousParams.toString()!==this.params.toString()}getPath2D(){return this.path2d}moveTo(e,t){this.openedPath=!0,this.path2d.moveTo(e,t),this.commands.push(0),this.params.push(e,t)}lineTo(e,t){this.openedPath?(this.path2d.lineTo(e,t),this.commands.push(1),this.params.push(e,t)):this.moveTo(e,t)}rect(e,t,n,i){this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+i),this.lineTo(e,t+i),this.closePath()}roundRect(e,t,n,i,s){s=Math.min(s,n/2,i/2),this.moveTo(e,t+s),this.arc(e+s,t+s,s,Math.PI,1.5*Math.PI),this.lineTo(e+s,t),this.lineTo(e+n-s,t),this.arc(e+n-s,t+s,s,1.5*Math.PI,2*Math.PI),this.lineTo(e+n,t+s),this.lineTo(e+n,t+i-s),this.arc(e+n-s,t+i-s,s,0,Math.PI/2),this.lineTo(e+n-s,t+i),this.lineTo(e+s,t+i),this.arc(e+ +s,t+i-s,s,Math.PI/2,Math.PI),this.lineTo(e,t+i-s),this.closePath()}arc(e,t,n,i,s,r){this.openedPath=!0,this.path2d.arc(e,t,n,i,s,r),this.commands.push(2),this.params.push(e,t,n,i,s,r?1:0)}cubicCurveTo(e,t,n,i,s,r){this.openedPath||this.moveTo(e,t),this.path2d.bezierCurveTo(e,t,n,i,s,r),this.commands.push(3),this.params.push(e,t,n,i,s,r)}closePath(){this.openedPath&&(this.path2d.closePath(),this.commands.push(4),this.openedPath=!1,this.closedPath=!0)}clear(e){e&&(this.previousCommands=this.commands,this.previousParams=this.params,this.previousClosedPath=this.closedPath),this.path2d=new Path2D,this.openedPath=!1,this.closedPath=!1,this.commands=[],this.params=[]}isPointInPath(e,t){const n=this.commands,i=this.params,s=n.length,r=-1e4,a=-1e4;let h=NaN,o=NaN,c=0,l=0,u=0;for(let d=0,f=0;d<s;d++)switch(n[d]){case 0:u+=segmentIntersection(h,o,c,l,r,a,e,t),c=i[f++],h=c,l=i[f++],o=l;break;case 1:u+=segmentIntersection(c,l,i[f++],i[f++],r,a,e,t),c=i[f-2],l=i[f-1];break;case 3:u+=cubicSegmentIntersections(c,l,i[f++],i[f++],i[f++],i[f++],i[f++],i[f++],r,a,e,t),c=i[f-2],l=i[f-1];break;case 2:{const p=i[f++],m=i[f++],g=i[f++],y=i[f++],M=i[f++],v=!!i[f++];if(u+=arcIntersections(p,m,g,y,M,v,r,a,e,t),!isNaN(h)){const R=p+Math.cos(y)*g,w=m+Math.sin(y)*g;u+=segmentIntersection(c,l,R,w,r,a,e,t)}c=p+Math.cos(M)*g,l=m+Math.sin(M)*g;break}case 4:u+=segmentIntersection(h,o,c,l,r,a,e,t);break}return u%2===1}distanceSquared(e,t){let n=1/0;const i=this.commands,s=this.params,r=i.length;let a=NaN,h=NaN,o=0,c=0;for(let l=0,u=0;l<r;l++)switch(i[l]){case 0:o=a=s[u++],c=h=s[u++];break;case 1:{const d=s[u++],f=s[u++];n=lineDistanceSquared(e,t,o,c,d,f,n);break}case 3:Logger.error("Command.Curve distanceSquare not implemented");break;case 2:{const d=s[u++],f=s[u++],p=s[u++],m=s[u++],g=s[u++],y=d+Math.cos(m)*p,M=f+Math.sin(m)*p,v=!!s[u++];n=lineDistanceSquared(e,t,o,c,y,M,n),n=arcDistanceSquared(e,t,d,f,p,m,g,v,n),o=d+Math.cos(g)*p,c=f+Math.sin(g)*p;break}case 4:n=lineDistanceSquared(e,t,o,c,a,h,n);break}return n}getPoints(){const{commands:e,params:t}=this,n=[];let i=0;for(const s of e)switch(s){case 0:case 1:n.push({x:t[i++],y:t[i++]});break;case 3:i+=4,n.push({x:t[i++],y:t[i++]});break;case 2:n.push({x:t[i++],y:t[i++]}),i+=4;break;case 4:break}return n}toSVG(e=(t,n)=>({x:t,y:n})){const t=[],{commands:n,params:i}=this,s=(a,...h)=>{t.push(a);for(let o=0;o<h.length;o+=2){const{x:c,y:l}=e(h[o],h[o+1]);t.push(c,l)}};let r=0;for(const a of n)switch(a){case 0:s("M",i[r++],i[r++]);break;case 1:s("L",i[r++],i[r++]);break;case 3:s("C",i[r++],i[r++],i[r++],i[r++],i[r++],i[r++]);break;case 2:{const h=i[r++],o=i[r++],c=i[r++],l=i[r++],u=i[r++],d=i[r++];let f=d?l-u:u-l;f<0&&(f+=Math.ceil(-f/(2*Math.PI))*2*Math.PI),d&&(f=-f);const p=Math.max(Math.ceil(Math.abs(f)/(Math.PI/2)),1),m=f/p,g=4/3*Math.tan(m/4),y=t.length===0?"M":"L";s(y,h+Math.cos(l)*c,o+Math.sin(l)*c);for(let M=0;M<p;M+=1){const v=l+m*(M+0),R=l+m*(M+1),w=c*Math.sin(v),P=c*Math.cos(v),x=c*Math.sin(R),b=c*Math.cos(R);s("C",h+P-g*w,o+w+g*P,h+b+g*x,o+x-g*b,h+b,o+x)}break}case 4:t.push("Z");break}return t.join(" ")}computeBBox(){const{commands:e,params:t}=this;let[n,i,s,r]=[1/0,1/0,-1/0,-1/0],[a,h]=[NaN,NaN],[o,c]=[NaN,NaN];const l=(d,f,p)=>{n=Math.min(f,n),i=Math.min(d,i),s=Math.max(d,s),r=Math.max(f,r),p&&([a,h]=[d,f])};let u=0;for(const d of e)switch(d){case 0:l(t[u++],t[u++],!0),[o,c]=[a,h];break;case 1:l(t[u++],t[u++],!0);break;case 3:{const f=t[u++],p=t[u++],m=t[u++],g=t[u++],y=t[u++],M=t[u++];l(y,M,!0),calculateDerivativeExtremaXY(a,h,f,p,m,g,y,M).forEach(R=>{const w=evaluateBezier(a,f,m,y,R),P=evaluateBezier(h,p,g,M,R);l(w,P)});break}case 2:{const f=t[u++],p=t[u++],m=t[u++];let g=normalizeAngle360(t[u++]),y=normalizeAngle360(t[u++]);t[u++]&&([g,y]=[y,g]);const v=(w,P)=>{const x=f+m*Math.cos(w),b=p+m*Math.sin(w);l(x,b,P)};v(g),v(y,!0);const R=[0,Math.PI/2,Math.PI,3*Math.PI/2];for(const w of R)(g<y&&g<=w&&w<=y||g>y&&(g<=w||w<=y))&&v(w);break}case 4:[a,h]=[o,c];break}return new BBox(i,n,s-i,r-n)}};function ScenePathChangeDetection(e){const{changeCb:t,convertor:n}=e??{};return SceneChangeDetection({type:"path",convertor:n,changeCb:t})}var Path=class extends Shape{constructor(){super(...arguments),this.path=new ExtendedPath2D,this._clipX=NaN,this._clipY=NaN,this.clip=!1,this._dirtyPath=!0}set clipX(e){this._clipX=e,this.dirtyPath=!0}set clipY(e){this._clipY=e,this.dirtyPath=!0}set dirtyPath(e){this._dirtyPath!==e&&(this._dirtyPath=e,e&&this.markDirty())}get dirtyPath(){return this._dirtyPath}checkPathDirty(){this._dirtyPath||(this.dirtyPath=this.path.isDirty()||(this.fillShadow?.isDirty()??!1)||(this._clipPath?.isDirty()??!1))}isPointInPath(e,t){return this.updatePathIfDirty(),this.path.closedPath&&this.path.isPointInPath(e,t)}distanceSquared(e,t){return this.distanceSquaredTransformedPoint(e,t)}svgPathData(e){return this.updatePathIfDirty(),this.path.toSVG(e)}distanceSquaredTransformedPoint(e,t){return this.updatePathIfDirty(),this.path.closedPath&&this.path.isPointInPath(e,t)?0:this.path.distanceSquared(e,t)}isDirtyPath(){return!1}updatePath(){}updatePathIfDirty(){(this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1)}preRender(){return this.updatePathIfDirty(),super.preRender(this.path.commands.length)}render(e){const{ctx:t}=e;if(this.clip&&!isNaN(this._clipX)&&!isNaN(this._clipY)){t.save();const n=this.strokeWidth/2;this._clipPath??(this._clipPath=new ExtendedPath2D),this._clipPath.clear(),this._clipPath.rect(-n,-n,this._clipX+n,this._clipY+n+n),t.clip(this._clipPath?.getPath2D()),this._clipX>0&&this._clipY>0&&this.drawPath(t),t.restore()}else this._clipPath=void 0,this.drawPath(t);this.fillShadow?.markClean(),super.render(e)}drawPath(e){this.fillStroke(e,this.path.getPath2D())}toSVG(){if(!this.visible)return;const e=document.createElementNS("http://www.w3.org/2000/svg","path");return e.setAttribute("d",this.svgPathData()),this.applySvgFillAttributes(e),this.applySvgStrokeAttributes(e),{elements:[e]}}};Path.className="Path",__decorateClass([ScenePathChangeDetection()],Path.prototype,"clip",2),__decorateClass([ScenePathChangeDetection()],Path.prototype,"clipX",1),__decorateClass([ScenePathChangeDetection()],Path.prototype,"clipY",1);var BUILTIN_MARKERS=["ArrowDown","ArrowUp","Circle","Cross","Diamond","Heart","MapPin","Plus","Square","Star","Triangle"],DEFAULT_CENTER_POINT=Object.freeze({x:.5,y:.5}),InternalMarker=class extends Path{constructor(){super(...arguments),this.x=0,this.y=0,this.size=12}isBuiltIn(){return BUILTIN_MARKERS.includes(this.constructor.className??"")}computeBBox(){if(!this.isBuiltIn())return this.updatePathIfDirty(),this.path.computeBBox();const{x:e,y:t,size:n}=this,{center:i}=this.constructor;return new BBox(e-n*i.x,t-n*i.y,n,n)}applyPath(e,t){const{path:n}=this;let{x:i,y:s}=this;n.clear();for(const{x:r,y:a,t:h}of t)i+=r*e,s+=a*e,h==="move"?n.moveTo(i,s):n.lineTo(i,s);n.closePath()}executeFill(e,t){if(t)return super.executeFill(e,t)}executeStroke(e,t){if(t)return super.executeStroke(e,t)}};__decorateClass([ScenePathChangeDetection()],InternalMarker.prototype,"x",2),__decorateClass([ScenePathChangeDetection()],InternalMarker.prototype,"y",2),__decorateClass([ScenePathChangeDetection({convertor:Math.abs})],InternalMarker.prototype,"size",2);var Marker=class extends Rotatable(Scalable(Translatable(InternalMarker))){};Marker.center=DEFAULT_CENTER_POINT;var Circle=class extends Marker{updatePath(){const{x:e,y:t,path:n,size:i}=this,s=i/2;n.clear(),n.arc(e,t,s,0,Math.PI*2),n.closePath()}};Circle.className="Circle";var durationSecond=1e3,durationMinute=durationSecond*60,durationHour=durationMinute*60,durationDay=durationHour*24,durationWeek=durationDay*7,durationMonth=durationDay*30,durationYear=durationDay*365,TimeInterval=class{constructor(e,t,n){this._encode=e,this._decode=t,this._rangeCallback=n}floor(e){const t=new Date(e),n=this._encode(t);return this._decode(n)}ceil(e){const t=new Date(Number(e)-1),n=this._encode(t);return this._decode(n+1)}range(e,t,n){const i=this._rangeCallback?.(e,t),s=this._encode(n?this.floor(e):this.ceil(e)),r=this._encode(n?this.ceil(t):this.floor(t));if(r<s)return[];const a=[];for(let h=s;h<=r;h++){const o=this._decode(h);a.push(o)}return i?.(),a}},CountableTimeInterval=class extends TimeInterval{getOffset(e,t){const n=typeof e=="number"||e instanceof Date?this._encode(new Date(e)):0;return Math.floor(n)%t}every(e,t){let n=0,i;const s=e;e=Math.max(1,Math.round(e)),s!==e&&Logger.warnOnce(`interval step of [${s}] rounded to [${e}].`);const{snapTo:r="start"}=t??{};if(typeof r=="string"){const o=n;i=(c,l)=>{const u=r==="start"?c:l;return n=this.getOffset(u,e),()=>n=o}}else typeof r=="number"?n=this.getOffset(new Date(r),e):r instanceof Date&&(n=this.getOffset(r,e));const a=o=>{const c=this._encode(o);return Math.floor((c-n)/e)},h=o=>this._decode(o*e+n);return new TimeInterval(a,h,i)}};function encode(e){const t=e.getTimezoneOffset()*durationMinute;return Math.floor((e.getTime()-t)/durationDay)}function decode(e){const t=new Date(1970,0,1);return t.setDate(t.getDate()+e),t}var day=new CountableTimeInterval(encode,decode),offset=new Date().getTimezoneOffset()*durationMinute;function encode2(e){return Math.floor((e.getTime()-offset)/durationHour)}function decode2(e){return new Date(offset+e*durationHour)}var hour=new CountableTimeInterval(encode2,decode2),offset2=new Date().getTimezoneOffset()*durationMinute;function encode3(e){return Math.floor((e.getTime()-offset2)/durationMinute)}function decode3(e){return new Date(offset2+e*durationMinute)}var minute=new CountableTimeInterval(encode3,decode3);function encode4(e){return e.getFullYear()*12+e.getMonth()}function decode4(e){const t=Math.floor(e/12),n=e-t*12;return new Date(t,n,1)}var month=new CountableTimeInterval(encode4,decode4),offset3=new Date().getTimezoneOffset()*durationMinute;function encode5(e){return Math.floor((e.getTime()-offset3)/durationSecond)}function decode5(e){return new Date(offset3+e*durationSecond)}var second=new CountableTimeInterval(encode5,decode5);function weekday(e){const n=(7+e-4)%7;function i(r){const a=r.getTimezoneOffset()*durationMinute;return Math.floor((r.getTime()-a)/durationWeek-n/7)}function s(r){const a=new Date(1970,0,1);return a.setDate(a.getDate()+r*7+n),a}return new CountableTimeInterval(i,s)}var sunday=weekday(0),monday=weekday(1),tuesday=weekday(2),wednesday=weekday(3),thursday=weekday(4),friday=weekday(5),saturday=weekday(6);function encode6(e){return e.getFullYear()}function decode6(e){const t=new Date;return t.setFullYear(e),t.setMonth(0,1),t.setHours(0,0,0,0),t}var year=new CountableTimeInterval(encode6,decode6);function dateToNumber(e){return e instanceof Date?e.getTime():e}var _BandScale=class rt{constructor(){this.type="band",this.invalid=!0,this.range=[0,1],this.round=!1,this.interval=void 0,this.index=new Map,this._domain=[],this._bandwidth=1,this._step=1,this._inset=1,this._rawBandwidth=1,this._paddingInner=0,this._paddingOuter=0}static is(t){return t instanceof rt}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&Logger.warnOnce("Expected update to not invalidate scale"))}set domain(t){this.index=new Map,this.invalid=!0,this._domain=[];for(const n of t){const i=dateToNumber(n);this.getIndex(i)===void 0&&this.index.set(i,this._domain.push(n)-1)}}get domain(){return this._domain}getDomain(){return this._domain}ticks(){return this.refresh(),this._domain}convert(t){this.refresh();const n=this.getIndex(t);return n==null||n<0||n>=this.domain.length?NaN:this.ordinalRange(n)}invertNearestIndex(t){this.refresh();const{domain:n}=this;if(n.length===0)return-1;let i=0,s=n.length-1,r=1/0,a=0;for(;i<=s;){const h=(s+i)/2|0,o=this.ordinalRange(h),c=Math.abs(o-t);if(c===0)return h;c<r&&(r=c,a=h),o<t?i=h+1:s=h-1}return a}invert(t){this.refresh();const n=this.invertNearestIndex(t),i=this.ordinalRange(n);return t===i?this.domain[n]:void 0}invertNearest(t){const n=this.invertNearestIndex(t);return this.domain[n]}get bandwidth(){return this.refresh(),this._bandwidth}get step(){return this.refresh(),this._step}get inset(){return this.refresh(),this._inset}get rawBandwidth(){return this.refresh(),this._rawBandwidth}set padding(t){t=clamp(0,t,1),this._paddingInner=t,this._paddingOuter=t}get padding(){return this._paddingInner}set paddingInner(t){this._paddingInner=clamp(0,t,1)}get paddingInner(){return this._paddingInner}set paddingOuter(t){this._paddingOuter=clamp(0,t,1)}get paddingOuter(){return this._paddingOuter}update(){const t=this._domain.length;if(t===0)return;const[n,i]=this.range;let{_paddingInner:s}=this;const{_paddingOuter:r,round:a}=this,h=i-n;let o;t===1?(s=0,o=h*(1-r*2)):o=h/Math.max(1,t-s+r*2);const c=a?Math.floor(o):o;let l=n+(h-c*(t-s))/2,u=c*(1-s);a&&(l=Math.round(l),u=Math.round(u)),this._step=c,this._inset=l,this._bandwidth=u,this._rawBandwidth=o*(1-s)}ordinalRange(t){const{_inset:n,_step:i,range:s}=this,r=Math.min(s[0],s[1]),a=Math.max(s[0],s[1]);return clamp(r,n+i*t,a)}getIndex(t){return this.index.get(t instanceof Date?t.getTime():t)}};__decorateClass([Invalidating],_BandScale.prototype,"range",2),__decorateClass([Invalidating],_BandScale.prototype,"round",2),__decorateClass([Invalidating],_BandScale.prototype,"interval",2);var BandScale=_BandScale;function parseFormat(e){let t,n;const i=surroundedRegEx.exec(e);i&&([,t,e,n]=i);const s=formatRegEx.exec(e);if(!s)throw new Error(`The number formatter is invalid: ${e}`);const[,r,a,h,o,c,l,u,d,f,p]=s;return{fill:r,align:a,sign:h,symbol:o,zero:c,width:parseInt(l),comma:u,precision:parseInt(d),trim:!!f,type:p,prefix:t,suffix:n}}function numberFormat(e){const t=typeof e=="string"?parseFormat(e):e,{fill:n,align:i,sign:s="-",symbol:r,zero:a,width:h,comma:o,type:c,prefix:l="",suffix:u="",precision:d}=t;let{trim:f}=t;const p=d==null||isNaN(d);let m;if(!c)m=decimalTypes.g,f=!0;else if(c in decimalTypes&&c in integerTypes)m=p?integerTypes[c]:decimalTypes[c];else if(c in decimalTypes)m=decimalTypes[c];else if(c in integerTypes)m=integerTypes[c];else throw new Error(`The number formatter type is invalid: ${c}`);let g;return d==null||p?g=c?6:12:g=d,y=>{let M=m(y,g);return f&&(M=removeTrailingZeros(M)),o&&(M=insertSeparator(M,o)),M=addSign(y,M,s),r&&r!=="#"&&(M=`${r}${M}`),r==="#"&&c==="x"&&(M=`0x${M}`),c==="s"&&(M=`${M}${getSIPrefix(y)}`),(c==="%"||c==="p")&&(M=`${M}%`),h!=null&&!isNaN(h)&&(M=addPadding(M,h,n??a,i)),M=`${l}${M}${u}`,M}}var formatRegEx=/^(?:(.)?([<>=^]))?([+\-( ])?([$€£¥₣₹#])?(0)?(\d+)?(,)?(?:\.(\d+))?(~)?([%a-z])?$/i,surroundedRegEx=/^((?:[^#]|#[^{])*)#{([^}]+)}(.*)$/,integerTypes={b:e=>absFloor(e).toString(2),c:e=>String.fromCharCode(e),d:e=>Math.round(Math.abs(e)).toFixed(0),o:e=>absFloor(e).toString(8),x:e=>absFloor(e).toString(16),X:e=>integerTypes.x(e).toUpperCase(),n:e=>integerTypes.d(e),"%":e=>`${absFloor(e*100).toFixed(0)}`},decimalTypes={e:(e,t)=>Math.abs(e).toExponential(t),E:(e,t)=>decimalTypes.e(e,t).toUpperCase(),f:(e,t)=>Math.abs(e).toFixed(t),F:(e,t)=>decimalTypes.f(e,t).toUpperCase(),g:(e,t)=>{if(e===0)return"0";const n=Math.abs(e),i=Math.floor(Math.log10(n));return i>=-4&&i<t?n.toFixed(t-1-i):n.toExponential(t-1)},G:(e,t)=>decimalTypes.g(e,t).toUpperCase(),n:(e,t)=>decimalTypes.g(e,t),p:(e,t)=>decimalTypes.r(e*100,t),r:(e,t)=>{if(e===0)return"0";const n=Math.abs(e),s=Math.floor(Math.log10(n))-(t-1);if(s<=0)return n.toFixed(-s);const r=10**s;return(Math.round(n/r)*r).toFixed()},s:(e,t)=>{const n=getSIPrefixPower(e);return decimalTypes.r(e/10**n,t)},"%":(e,t)=>decimalTypes.f(e*100,t)},minSIPrefix=-24,maxSIPrefix=24,siPrefixes={[minSIPrefix]:"y",[-21]:"z",[-18]:"a",[-15]:"f",[-12]:"p",[-9]:"n",[-6]:"\xB5",[-3]:"m",0:"",3:"k",6:"M",9:"G",12:"T",15:"P",18:"E",21:"Z",[maxSIPrefix]:"Y"},minusSign="\u2212";function absFloor(e){return Math.floor(Math.abs(e))}function removeTrailingZeros(e){return e.replace(/\.0+$/,"").replace(/(\.[1-9])0+$/,"$1")}function insertSeparator(e,t){let n=e.indexOf(".");n<0&&(n=e.length);const i=e.substring(0,n).split(""),s=e.substring(n);for(let r=i.length-3;r>0;r-=3)i.splice(r,0,t);return`${i.join("")}${s}`}function getSIPrefix(e){return siPrefixes[getSIPrefixPower(e)]}function getSIPrefixPower(e){return clamp(minSIPrefix,e?Math.floor(Math.log10(Math.abs(e))/3)*3:0,maxSIPrefix)}function addSign(e,t,n=""){if(n==="(")return e>=0?t:`(${t})`;const i=n==="+"?"+":"";return`${e>=0?i:minusSign}${t}`}function addPadding(e,t,n=" ",i=">"){let s=e;if(i===">"||!i)s=s.padStart(t,n);else if(i==="<")s=s.padEnd(t,n);else if(i==="^"){const r=Math.max(0,t-s.length),a=Math.ceil(r/2),h=Math.floor(r/2);s=s.padStart(a+s.length,n),s=s.padEnd(h+s.length,n)}return s}function encode7(e){return e.getTime()}function decode7(e){return new Date(e)}var millisecond=new CountableTimeInterval(encode7,decode7),tInterval=(e,t,n)=>({duration:t*n,timeInterval:e,step:n}),TickIntervals=[tInterval(second,durationSecond,1),tInterval(second,durationSecond,5),tInterval(second,durationSecond,15),tInterval(second,durationSecond,30),tInterval(minute,durationMinute,1),tInterval(minute,durationMinute,5),tInterval(minute,durationMinute,15),tInterval(minute,durationMinute,30),tInterval(hour,durationHour,1),tInterval(hour,durationHour,3),tInterval(hour,durationHour,6),tInterval(hour,durationHour,12),tInterval(day,durationDay,1),tInterval(day,durationDay,2),tInterval(sunday,durationWeek,1),tInterval(sunday,durationWeek,2),tInterval(sunday,durationWeek,3),tInterval(month,durationMonth,1),tInterval(month,durationMonth,2),tInterval(month,durationMonth,3),tInterval(month,durationMonth,4),tInterval(month,durationMonth,6),tInterval(year,durationYear,1)],TickMultipliers=[1,2,5,10];function isCloseToInteger(e,t){return Math.abs(Math.round(e)-e)<t}function createTicks(e,t,n,i,s){if(n<2)return[e,t];const r=tickStep(e,t,n,i,s);return Number.isFinite(r)?(isCloseToInteger(e/r,1e-12)||(e=Math.ceil(e/r)*r),isCloseToInteger(t/r,1e-12)||(t=Math.floor(t/r)*r),range(e,t,r)):[]}function tickStep(e,t,n,i=0,s=1/0){if(e===t)return clamp(1,i,s);if(n<1)return NaN;const r=Math.abs(t-e),a=10**Math.floor(Math.log10(r/n));let h=NaN,o=1/0,c=!1;for(const l of TickMultipliers){const u=Math.ceil(r/(l*a)),d=u>=i&&u<=s;if(c&&!d)continue;const f=Math.abs(u-n);(o>f||c!==d)&&(c||(c=d),o=f,h=l)}return h*a}function decimalPlaces(e){for(let t=e.length-1;t>=0;t-=1)if(e[t]!=="0")return t+1;return 0}function tickFormat(e,t){const n=parseFormat(t??",f");(n.precision==null||isNaN(n.precision))&&(!n.type||"eEFgGnprs".includes(n.type)?n.precision=Math.max(...e.map(s=>{if(!Number.isFinite(s))return 0;const[r,a]=s.toExponential((n.type?6:12)-1).split(/[.e]/g);return(r!=="1"&&r!=="-1"?1:0)+decimalPlaces(a)+1})):"f%".includes(n.type)&&(n.precision=Math.max(...e.map(s=>{if(!Number.isFinite(s)||s===0)return 0;const r=Math.floor(Math.log10(Math.abs(s))),a=n.type?6:12,h=s.toExponential(a-1).split(/[.e]/g)[1],o=decimalPlaces(h);return Math.max(0,o-r)}))));const i=numberFormat(n);return s=>i(Number(s))}function range(e,t,n){if(!Number.isFinite(n)||n<=0)return[];const i=10**countFractionDigits(n),s=Math.min(e,t),r=Math.max(e,t),a=[];for(let h=0;;h+=1){const o=Math.round((s+n*h)*i)/i;if(o>r)break;a.push(o)}return a}function isDenseInterval(e,t){return e>=t?(Logger.warnOnce("the configured interval results in more than 1 item per pixel, ignoring. Supply a larger interval or omit this configuration"),!0):!1}function niceTicksDomain(e,t){const n=Math.abs(t-e),i=10**Math.floor(Math.log10(n));let s=1/0,r=[e,t];for(const a of TickMultipliers){const h=a*i,o=Math.floor(e/h)*h,c=Math.ceil(t/h)*h,l=1-n/Math.abs(c-o);s>l&&(s=l,r=[o,c])}return r}var _ContinuousScale=class Y{constructor(t,n){this.invalid=!0,this.nice=!1,this.interval=void 0,this.tickCount=Y.defaultTickCount,this.minTickCount=0,this.maxTickCount=1/0,this.niceDomain=[],this.defaultClamp=!1,this.domain=t,this.range=n}static is(t){return t instanceof Y}transform(t){return t}transformInvert(t){return t}calcBandwidth(t=1){const n=this.getDomain(),i=this.getPixelRange(),s=Math.abs(n[1]-n[0])/t+1,r=Math.floor(i),a=Math.min(s,r);return i/Math.max(1,a)}getDomain(){return this.nice&&(this.refresh(),this.niceDomain.length)?this.niceDomain:this.domain}convert(t,n){if(!this.domain||this.domain.length<2)return NaN;this.refresh();const i=this.getDomain().map(c=>this.transform(c)),[s,r]=i,{range:a}=this,[h,o]=a;if(t=this.transform(t),n??this.defaultClamp){const[c,l]=findMinMax(i.map(Number));if(Number(t)<c)return h;if(Number(t)>l)return o}return s===r?(h+o)/2:t===s?h:t===r?o:h+(Number(t)-Number(s))/(Number(r)-Number(s))*(o-h)}invert(t,n){this.refresh();const i=this.getDomain().map(f=>this.transform(f)),[s,r]=i,{range:a}=this,[h,o]=a,c=h>o,l=c?o:h,u=c?h:o;if(n??this.defaultClamp){if(t<l)return c?r:s;if(t>u)return c?s:r}let d;return h===o?d=this.toDomain((Number(s)+Number(r))/2):d=this.toDomain(Number(s)+(t-h)/(o-h)*(Number(r)-Number(s))),this.transformInvert(d)}refresh(){this.invalid&&(this.invalid=!1,this.update(),this.invalid&&Logger.warnOnce("Expected update to not invalidate scale"))}getPixelRange(){const[t,n]=this.range;return Math.abs(n-t)}};_ContinuousScale.defaultTickCount=5,_ContinuousScale.defaultMaxTickCount=6,__decorateClass([Invalidating],_ContinuousScale.prototype,"domain",2),__decorateClass([Invalidating],_ContinuousScale.prototype,"range",2),__decorateClass([Invalidating],_ContinuousScale.prototype,"nice",2),__decorateClass([Invalidating],_ContinuousScale.prototype,"interval",2),__decorateClass([Invalidating],_ContinuousScale.prototype,"tickCount",2),__decorateClass([Invalidating],_ContinuousScale.prototype,"minTickCount",2),__decorateClass([Invalidating],_ContinuousScale.prototype,"maxTickCount",2);var ContinuousScale=_ContinuousScale,LinearScale=class extends ContinuousScale{constructor(){super([0,1],[0,1]),this.type="number"}toDomain(e){return e}ticks(){const e=this.tickCount??ContinuousScale.defaultTickCount;if(!this.domain||this.domain.length<2||e<1||!this.domain.every(isFinite))return[];this.refresh();const[t,n]=this.getDomain();if(this.interval){const i=Math.abs(this.interval);if(!isDenseInterval((n-t)/i,this.getPixelRange()))return range(t,n,i)}return createTicks(t,n,e,this.minTickCount,this.maxTickCount)}update(){!this.domain||this.domain.length<2||this.nice&&this.updateNiceDomain()}getTickStep(e,t){return this.interval??tickStep(e,t,this.tickCount,this.minTickCount,this.maxTickCount)}updateNiceDomain(){const e=this.tickCount;let[t,n]=this.domain;if(e===1)[t,n]=niceTicksDomain(t,n);else if(e>1){const i=t>n?Math.ceil:Math.floor,s=t>n?Math.floor:Math.ceil,r=4;for(let a=0;a<r;a++){const h=t,o=n,c=this.getTickStep(t,n),[l,u]=this.domain;if(t=i(l/c)*c,n=s(u/c)*c,t===h&&n===o)break}}this.niceDomain=[t,n]}tickFormat({ticks:e,specifier:t}){return tickFormat(e??this.ticks(),t)}};function ascendingStringNumberUndefined(e,t){return typeof e=="number"&&typeof t=="number"?e-t:typeof e=="string"&&typeof t=="string"?e.localeCompare(t):e==null&&t==null?0:e==null?-1:t==null?1:String(e).localeCompare(String(t))}var cmp=(e,t)=>Math.sign(e-t);function compareZIndex(e,t){if(typeof e=="number"&&typeof t=="number")return cmp(e,t);const n=typeof e=="number"?[e]:e,i=typeof t=="number"?[t]:t,s=Math.min(n.length,i.length);for(let r=0;r<s;r+=1){const a=cmp(n[r],i[r]);if(a!==0)return a}return cmp(n.length,i.length)}var _Group=class W extends Node{constructor(t){super(t),this.opacity=1,this.layer=void 0,this.renderToOffscreenCanvas=!1,this.isContainerNode=!0,this.renderToOffscreenCanvas=t?.renderToOffscreenCanvas===!0}static is(t){return t instanceof W}static computeChildrenBBox(t,n=!0){return BBox.merge(Node.extractBBoxes(t,n))}static compareChildren(t,n){return compareZIndex(t.zIndex,n.zIndex)||ascendingStringNumberUndefined(t.serialNumber,n.serialNumber)}containsPoint(t,n){return!0}computeBBox(){return W.computeChildrenBBox(this.children())}isDirty(t){const{resized:n}=t,{dirty:i,dirtyZIndex:s}=this;if(i||s||n)return!0;for(const r of this.children())if(r.dirty)return!0;return!1}preRender(){const t=super.preRender(0);return t.groups+=1,t.nonGroups-=1,this.renderToOffscreenCanvas&&t.nonGroups>0&&this.getVisibility()?this.layer??(this.layer=this._layerManager?.addLayer({name:this.name})):this.layer!=null&&(this._layerManager?.removeLayer(this.layer),this.layer=void 0),t}render(t){const{layer:n}=this,i={...t};if(n==null){this.renderInContext(i),super.render(i);return}const{ctx:s,stats:r}=t;if(this.isDirty(t)){const a=s.getTransform(),{globalAlpha:h}=s,o=n.context;i.ctx=o,n.clear(),o.save(),o.setTransform(a),o.globalAlpha=h,this.renderInContext(i),o.restore(),o.verifyDepthZero?.(),r&&r.layersRendered++}else this.skipRender(i),r&&r.layersSkipped++;s.save(),s.resetTransform(),n.drawImage(s),s.restore(),super.render(i)}skipRender(t){const{stats:n}=t;for(const i of this.children())i.markClean(),n&&(n.nodesSkipped+=this.childNodeCounts.groups+this.childNodeCounts.nonGroups,n.opsSkipped+=this.childNodeCounts.complexity)}applyClip(t,n){const{x:i,y:s,width:r,height:a}=n;t.beginPath(),t.rect(i,s,r,a),t.clip()}renderInContext(t){const{ctx:n,stats:i}=t;this.dirtyZIndex&&this.sortChildren(W.compareChildren),n.save(),n.globalAlpha*=this.opacity,this.clipRect!=null&&(this.applyClip(n,this.clipRect),t.clipBBox=Transformable.toCanvas(this,this.clipRect));for(const s of this.children()){if(!s.visible){s.markClean(),i&&(i.nodesSkipped+=s.childNodeCounts.nonGroups+s.childNodeCounts.groups,i.opsSkipped+=s.childNodeCounts.complexity);continue}n.save(),s.render(t),n.restore()}n.restore()}setClipRect(t){this.clipRect=t?Transformable.fromCanvas(this,t):void 0}setClipRectCanvasSpace(t){this.clipRect=t}_setLayerManager(t){this.layer&&(this._layerManager?.removeLayer(this.layer),this.layer=void 0),super._setLayerManager(t)}getVisibility(){for(const t of this.traverseUp(!0))if(!t.visible)return!1;return!0}toSVG(){if(!this.visible)return;const t=[],n=[];for(const i of this.children()){const s=i.toSVG();s!=null&&(n.push(...s.elements),s.defs!=null&&t.push(...s.defs))}return{elements:n,defs:t}}};_Group.className="Group",__decorateClass([SceneChangeDetection({convertor:e=>clamp(0,e,1)})],_Group.prototype,"opacity",2);var Group=_Group,ScalableGroup=class extends Scalable(Group){},RotatableGroup=class extends Rotatable(Group){},TranslatableGroup=class extends Translatable(Group){},TransformableGroup=class extends Rotatable(Translatable(Group)){};function toArray(e){return typeof e>"u"?[]:Array.isArray(e)?e:[e]}var verifiedGlobals={};typeof window<"u"?verifiedGlobals.window=window:typeof global<"u"&&(verifiedGlobals.window=global.window),typeof document<"u"?verifiedGlobals.document=document:typeof global<"u"&&(verifiedGlobals.document=global.document);function getDocument(e){return e?verifiedGlobals.document?.[e]:verifiedGlobals.document}function getWindow(e){return e?verifiedGlobals.window?.[e]:verifiedGlobals.window}function createElement(e,t,n){const i=getDocument().createElement(e);if(typeof t=="object"&&(n=t,t=void 0),t)for(const s of t.split(" "))i.classList.add(s);return n&&Object.assign(i.style,n),i}function downloadUrl(e,t){const{body:n}=getDocument(),i=createElement("a",{display:"none"});i.href=e,i.download=t,n.appendChild(i),i.click(),setTimeout(()=>n.removeChild(i))}var LONG_TIME_PERIOD_THRESHOLD=2e3,timeOfLastLog=Date.now(),logTimeGap=()=>{const e=Date.now()-timeOfLastLog;if(e>LONG_TIME_PERIOD_THRESHOLD){const t=(Math.floor(e/100)/10).toFixed(1);Logger.log(`**** ${t}s since last log message ****`)}timeOfLastLog=Date.now()},Debug={create(...e){return Object.assign((...n)=>{Debug.check(...e)&&(typeof n[0]=="function"&&(n=toArray(n[0]())),logTimeGap(),Logger.log(...n))},{check:()=>Debug.check(...e)})},check(...e){return e.length===0&&e.push(!0),toArray(getWindow("agChartsDebug")).some(n=>e.includes(n))}};function clearContext({context:e,pixelRatio:t,width:n,height:i}){e.save(),e.setTransform(t,0,0,t,0,0),e.clearRect(0,0,n,i),e.restore()}function debugContext(e){if(Debug.check("canvas")){const t=e.save.bind(e),n=e.restore.bind(e);let i=0;Object.assign(e,{save(){t(),i++},restore(){if(i===0)throw new Error("AG Charts - Unable to restore() past depth 0");n(),i--},verifyDepthZero(){if(i!==0)throw new Error(`AG Charts - Save/restore depth is non-zero: ${i}`)}})}}var HdpiCanvas=class{constructor(e){this.enabled=!0,this.width=600,this.height=300;const{width:t,height:n,pixelRatio:i,canvasElement:s,willReadFrequently:r=!1}=e;this.pixelRatio=i??getWindow("devicePixelRatio"),this.element=s??createElement("canvas"),this.element.style.display="block",this.element.style.width=(t??this.width)+"px",this.element.style.height=(n??this.height)+"px",this.element.width=Math.round((t??this.width)*this.pixelRatio),this.element.height=Math.round((n??this.height)*this.pixelRatio),this.context=this.element.getContext("2d",{willReadFrequently:r}),this.onEnabledChange(),this.resize(t??0,n??0),debugContext(this.context)}drawImage(e,t=0,n=0){return e.drawImage(this.context.canvas,t,n)}toDataURL(e){return this.element.toDataURL(e)}resize(e,t){if(!(e>0&&t>0))return;const{element:n,context:i,pixelRatio:s}=this;n.width=Math.round(e*s),n.height=Math.round(t*s),i.setTransform(s,0,0,s,0,0),n.style.width=e+"px",n.style.height=t+"px",this.width=e,this.height=t}clear(){clearContext(this)}destroy(){this.element.remove(),this.element.width=0,this.element.height=0,this.context.clearRect(0,0,0,0),Object.freeze(this)}onEnabledChange(){this.element&&(this.element.style.display=this.enabled?"":"none")}};__decorateClass([ObserveChanges(e=>e.onEnabledChange())],HdpiCanvas.prototype,"enabled",2);var HdpiOffscreenCanvas=class{constructor(e){this.width=600,this.height=300;const{width:t,height:n,pixelRatio:i,willReadFrequently:s=!1}=e;this.pixelRatio=i??getWindow("devicePixelRatio"),this.canvas=new OffscreenCanvas(t??this.width,n??this.height),this.context=this.canvas.getContext("2d",{willReadFrequently:s}),this.resize(t??0,n??0),debugContext(this.context)}drawImage(e,t=0,n=0){return e.drawImage(this.context.canvas,t,n)}resize(e,t){if(!(e>0&&t>0))return;const{canvas:n,context:i,pixelRatio:s}=this;n.width=Math.round(e*s),n.height=Math.round(t*s),i.setTransform(s,0,0,s,0,0),this.width=e,this.height=t}clear(){clearContext(this)}destroy(){this.canvas.width=0,this.canvas.height=0,this.context.clearRect(0,0,0,0),this.canvas=null,this.context=null,Object.freeze(this)}},LayersManager=class{constructor(e){this.canvas=e,this.debug=Debug.create(!0,"scene"),this.layersMap=new Map,this.nextLayerId=0}get size(){return this.layersMap.size}resize(e,t){this.canvas.resize(e,t),this.layersMap.forEach(({canvas:n})=>n.resize(e,t))}addLayer(e){const{width:t,height:n,pixelRatio:i}=this.canvas,{name:s}=e,r=new HdpiOffscreenCanvas({width:t,height:n,pixelRatio:i});return this.layersMap.set(r,{id:this.nextLayerId++,name:s,canvas:r}),this.debug("Scene.addLayer() - layers",this.layersMap),r}removeLayer(e){this.layersMap.has(e)&&(this.layersMap.delete(e),e.destroy(),this.debug("Scene.removeLayer() -  layers",this.layersMap))}clear(){for(const e of this.layersMap.values())e.canvas.destroy();this.layersMap.clear()}},_SpriteRenderer=class at{constructor(){this.offscreenCanvas=new OffscreenCanvas(1,1),at.offscreenCanvasCount++;const t=this.offscreenCanvas.getContext("2d");if(t==null)throw new TypeError("AG Charts - invalid 2d context");this.renderCtx={ctx:t,devicePixelRatio:1,resized:!1,debugNodes:{}}}resize({spritePixelRatio:t,spriteWidth:n,spriteHeight:i}){this.offscreenCanvas.width=Math.max(n,0)*t,this.offscreenCanvas.height=Math.max(i,0)*t}renderSprite(t,n){t=toIterable(t);const{renderCtx:i,renderCtx:{ctx:s},offscreenCanvas:r}=this,{scale:a=1,translateX:h=0,translateY:o=0}=n??{};s.save(),s.resetTransform(),s.clearRect(0,0,r.width,r.height),s.beginPath(),s.setTransform(a,0,0,a,h,o);for(const c of t)c.preRender(),c.render(i);return s.closePath(),s.restore(),r.transferToImageBitmap()}};_SpriteRenderer.offscreenCanvasCount=0;var SpriteRenderer=_SpriteRenderer;function formatBytes(e){for(const t of["B","KB","MB","GB"]){if(e<1536)return`${e.toFixed(1)}${t}`;e/=1024}return`${e.toFixed(1)}TB}`}function memoryUsage(){if(!("memory"in performance))return;const{totalJSHeapSize:e,usedJSHeapSize:t,jsHeapSizeLimit:n}=performance.memory,i=[];for(const s of[t,e,n])typeof s=="number"&&i.push(formatBytes(s));return`Heap ${i.join(" / ")}`}function debugStats(e,t,n,i,s={},r=BBox.zero){if(!Debug.check("scene:stats","scene:stats:verbose"))return;const{layersRendered:a=0,layersSkipped:h=0,nodesRendered:o=0,nodesSkipped:c=0,opsPerformed:l=0,opsSkipped:u=0}=i??{},d=performance.now(),{start:f,...p}=t,m=Object.entries(p).map(([S,N])=>time(S,N)).filter(S=>S!=null).join(" + "),g=Object.entries(s).map(([S,N])=>`${S}: ${JSON.stringify(N)}`).join(" ; "),y=Debug.check("scene:stats:verbose"),M=memoryUsage(),v=[`${time("\u23F1\uFE0F",f,d)} (${m})`,`${g}`,`Layers: ${y?pct(a,h):e.size}; Sprites: ${SpriteRenderer.offscreenCanvasCount}`,y?`Nodes: ${pct(o,c)}`:null,y?`Ops: ${pct(l,u)}`:null,y&&M?M:null].filter(isString),R=new SimpleTextMeasurer(S=>n.measureText(S)),w=new Map(v.map(S=>[S,R.measureLines(S)])),P=Math.max(...Array.from(w.values(),S=>S.width)),x=accumulate(w.values(),S=>S.height),b=2+r.x;n.save(),n.fillStyle="white",n.fillRect(b,0,P,x),n.fillStyle="black";let C=0;for(const[S,N]of w.entries())C+=N.height,n.fillText(S,b,C);n.restore()}function prepareSceneNodeHighlight(e){const t=toArray(getWindow("agChartsSceneDebug")),n=[];for(const i of t)i==="layout"?n.push("seriesRoot","legend","root",/.*Axis-\d+-axis.*/):n.push(i);e.debugNodeSearch=n}function debugSceneNodeHighlight(e,t){e.save();for(const[n,i]of Object.entries(t)){const s=Transformable.toCanvas(i);if(!s){Logger.log(`Scene.render() - no bbox for debugged node [${n}].`);continue}e.globalAlpha=.8,e.strokeStyle="red",e.lineWidth=1,e.strokeRect(s.x,s.y,s.width,s.height),e.fillStyle="red",e.strokeStyle="white",e.font="16px sans-serif",e.textBaseline="top",e.textAlign="left",e.lineWidth=2,e.strokeText(n,s.x,s.y,s.width),e.fillText(n,s.x,s.y,s.width)}e.restore()}var skippedProperties=new Set,allowedProperties=new Set(["gradient","zIndex","clipRect","cachedBBox","childNodeCounts","path","__zIndex","name","__scalingCenterX","__scalingCenterY","__rotationCenterX","__rotationCenterY","_previousDatum","__fill","__lineDash","borderPath","borderClipPath","_clipPath"]);function nodeProps(e){const{...t}=e;for(const n of Object.keys(t))allowedProperties.has(n)||typeof t[n]!="number"&&typeof t[n]!="string"&&typeof t[n]!="boolean"&&(skippedProperties.add(n),delete t[n]);return t}function buildTree(e,t){if(!Debug.check(!0,"scene"))return{};let n=0;return{node:t==="json"?nodeProps(e):e,name:e.name??e.id,dirty:e.dirty,...Array.from(e.children(),i=>buildTree(i,t)).reduce((i,s)=>{let{name:r}=s;const{node:{visible:a,opacity:h,zIndex:o,translationX:c,translationY:l,rotation:u,scalingX:d,scalingY:f},node:p}=s;(!a||h<=0)&&(r=`(${r})`),Group.is(p)&&p.renderToOffscreenCanvas&&(r=`*${r}*`);const m=Array.isArray(o)?`(${o.join(", ")})`:o,g=[`${(n++).toString().padStart(3,"0")}|`,`${r??"<unknown>"}`,`z: ${m}`,c&&`x: ${c}`,l&&`y: ${l}`,u&&`r: ${u}`,d!=null&&d!==1&&`sx: ${d}`,f!=null&&f!==1&&`sy: ${f}`].filter(v=>!!v).join(" ");let y=g,M=1;for(;i[y]!=null&&M<100;)y=`${g} (${M++})`;return i[y]=s,i},{})}}function buildDirtyTree(e){if(!e.dirty)return{dirtyTree:{},paths:[]};const t=Array.from(e.children(),s=>buildDirtyTree(s)).filter(s=>s.paths.length>0),n=Group.is(e)?e.name??e.id:e.id,i=t.length?t.flatMap(s=>s.paths).map(s=>`${n}.${s}`):[n];return{dirtyTree:{name:n,node:e,dirty:e.dirty,...t.map(s=>s.dirtyTree).filter(s=>s.dirty!=null).reduce((s,r)=>(s[r.name??"<unknown>"]=r,s),{})},paths:i}}function pct(e,t){const n=e+t;return`${e} / ${n} (${Math.round(100*e/n)}%)`}function time(e,t,n){const i=n!=null?n-t:t;return`${e}: ${Math.round(i*100)/100}ms`}function accumulate(e,t){let n=0;for(const i of e)n+=t(i);return n}var Scene=class{constructor(e){this.debug=Debug.create(!0,"scene"),this.id=createId(this),this.root=null,this.pendingSize=null,this.isDirty=!1,this.canvas=new HdpiCanvas(e),this.layersManager=new LayersManager(this.canvas)}get width(){return this.pendingSize?.[0]??this.canvas.width}get height(){return this.pendingSize?.[1]??this.canvas.height}setContainer(e){const{element:t}=this.canvas;return t.parentElement?.removeChild(t),e.appendChild(t),this}setRoot(e){return this.root===e?this:(this.isDirty=!0,this.root?._setLayerManager(),this.root=e,e&&(e.visible=!0,e._setLayerManager(this.layersManager)),this)}clear(){this.canvas.clear()}attachNode(e){return this.appendChild(e),()=>this.removeChild(e)}appendChild(e){return this.root?.appendChild(e),this}removeChild(e){return this.root?.removeChild(e),this}download(e,t){downloadUrl(this.canvas.toDataURL(t),e?.trim()??"image")}getDataURL(e){return this.canvas.toDataURL(e)}resize(e,t){return e=Math.round(e),t=Math.round(t),e>0&&t>0&&(e!==this.width||t!==this.height)?(this.pendingSize=[e,t],this.isDirty=!0,!0):!1}render(e){const{debugSplitTimes:t={start:performance.now()},extraDebugStats:n,seriesRect:i}=e??{},{canvas:s,canvas:{context:r}={},root:a,pendingSize:h}=this;if(!r)return;const o=performance.now();if(h&&(this.layersManager.resize(...h),this.pendingSize=null),a&&!a.visible){this.isDirty=!1;return}if(a?.dirty===!1&&!this.isDirty){this.debug.check()&&this.debug("Scene.render() - no-op",{tree:buildTree(a,"console")}),debugStats(this.layersManager,t,r,void 0,n,i);return}const c={ctx:r,devicePixelRatio:this.canvas.pixelRatio??1,resized:!!h,debugNodes:{}};Debug.check("scene:stats:verbose")&&(c.stats={layersRendered:0,layersSkipped:0,nodesRendered:0,nodesSkipped:0,opsPerformed:0,opsSkipped:0}),prepareSceneNodeHighlight(c);let l=!1;if(a?.dirty!==!1&&(l=!0,s.clear()),a&&Debug.check("scene:dirtyTree")){const{dirtyTree:u,paths:d}=buildDirtyTree(a);Debug.create("scene:dirtyTree")("Scene.render() - dirtyTree",{dirtyTree:u,paths:d})}if(a&&l){if(a.visible&&a.preRender(),this.debug.check()){const u=buildTree(a,"console");this.debug("Scene.render() - before",{canvasCleared:l,tree:u})}a.visible&&(r.save(),a.render(c),r.restore())}t["\u270D\uFE0F"]=performance.now()-o,r.verifyDepthZero?.(),this.isDirty=!1,debugStats(this.layersManager,t,r,c.stats,n,i),debugSceneNodeHighlight(r,c.debugNodes),a&&this.debug.check()&&this.debug("Scene.render() - after",{tree:buildTree(a,"console"),canvasCleared:l})}toSVG(){const{root:e,width:t,height:n}=this;if(e!=null)return Node.toSVG(e,t,n)}strip(){const{context:e,pixelRatio:t}=this.canvas;e.setTransform(t,0,0,t,0,0),this.layersManager.clear(),this.setRoot(null),this.isDirty=!1}destroy(){this.strip(),this.canvas.destroy(),Object.assign(this,{canvas:void 0})}};Scene.className="Scene";var Arc=class extends Path{constructor(){super(),this.centerX=0,this.centerY=0,this.radius=10,this.startAngle=0,this.endAngle=Math.PI*2,this.counterClockwise=!1,this.type=0,this.restoreOwnStyles()}get fullPie(){return isNumberEqual(normalizeAngle360(this.startAngle),normalizeAngle360(this.endAngle))}updatePath(){const e=this.path;e.clear(),e.arc(this.centerX,this.centerY,this.radius,this.startAngle,this.endAngle,this.counterClockwise),this.type===1?e.closePath():this.type===2&&!this.fullPie&&(e.lineTo(this.centerX,this.centerY),e.closePath())}computeBBox(){return new BBox(this.centerX-this.radius,this.centerY-this.radius,this.radius*2,this.radius*2)}isPointInPath(e,t){const n=this.getBBox();return this.type!==0&&n.containsPoint(e,t)&&this.path.isPointInPath(e,t)}};Arc.className="Arc",Arc.defaultStyles={...Shape.defaultStyles,lineWidth:1,fillStyle:null},__decorateClass([ScenePathChangeDetection()],Arc.prototype,"centerX",2),__decorateClass([ScenePathChangeDetection()],Arc.prototype,"centerY",2),__decorateClass([ScenePathChangeDetection()],Arc.prototype,"radius",2),__decorateClass([ScenePathChangeDetection()],Arc.prototype,"startAngle",2),__decorateClass([ScenePathChangeDetection()],Arc.prototype,"endAngle",2),__decorateClass([ScenePathChangeDetection()],Arc.prototype,"counterClockwise",2),__decorateClass([ScenePathChangeDetection()],Arc.prototype,"type",2);var Line=class extends Shape{constructor(e={}){super(e),this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.restoreOwnStyles()}set x(e){this.x1=e,this.x2=e}set y(e){this.y1=e,this.y2=e}get midPoint(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}}computeBBox(){return new BBox(Math.min(this.x1,this.x2),Math.min(this.y1,this.y2),Math.abs(this.x2-this.x1),Math.abs(this.y2-this.y1))}isPointInPath(e,t){return this.x1===this.x2||this.y1===this.y2?this.getBBox().clone().grow(this.strokeWidth/2).containsPoint(e,t):!1}distanceSquared(e,t){const{x1:n,y1:i,x2:s,y2:r}=this;return lineDistanceSquared(e,t,n,i,s,r,1/0)}render(e){const{ctx:t,devicePixelRatio:n}=e;let{x1:i,y1:s,x2:r,y2:a}=this;if(i===r){const{strokeWidth:h}=this,o=Math.round(i*n)/n+Math.trunc(h*n)%2/(n*2);i=o,r=o}else if(s===a){const{strokeWidth:h}=this,o=Math.round(s*n)/n+Math.trunc(h*n)%2/(n*2);s=o,a=o}t.beginPath(),t.moveTo(i,s),t.lineTo(r,a),this.fillStroke(t),this.fillShadow?.markClean(),super.render(e)}toSVG(){if(!this.visible)return;const e=document.createElementNS("http://www.w3.org/2000/svg","line");return e.setAttribute("x1",String(this.x1)),e.setAttribute("y1",String(this.y1)),e.setAttribute("x2",String(this.x2)),e.setAttribute("y2",String(this.y2)),this.applySvgStrokeAttributes(e),{elements:[e]}}};Line.className="Line",Line.defaultStyles={...Shape.defaultStyles,fill:void 0,strokeWidth:1},__decorateClass([SceneChangeDetection()],Line.prototype,"x1",2),__decorateClass([SceneChangeDetection()],Line.prototype,"y1",2),__decorateClass([SceneChangeDetection()],Line.prototype,"x2",2),__decorateClass([SceneChangeDetection()],Line.prototype,"y2",2);function rotatePoint(e,t,n){const i=Math.sqrt(e**2+t**2),r=Math.atan2(t,e)+n;return{x:Math.cos(r)*i,y:Math.sin(r)*i}}var RadialColumnShape=class extends Path{constructor(){super(...arguments),this.isBeveled=!0,this.columnWidth=0,this.startAngle=0,this.endAngle=0,this.outerRadius=0,this.innerRadius=0,this.axisInnerRadius=0,this.axisOuterRadius=0,this.isRadiusAxisReversed=!1}set cornerRadius(e){}computeBBox(){const{innerRadius:e,outerRadius:t,columnWidth:n}=this,i=this.getRotation(),s=-n/2,r=n/2,a=-t,h=-e;let o=1/0,c=1/0,l=-1/0,u=-1/0;for(let d=0;d<4;d+=1){const{x:f,y:p}=rotatePoint(d%2===0?s:r,d<2?a:h,i);o=Math.min(f,o),c=Math.min(p,c),l=Math.max(f,l),u=Math.max(p,u)}return new BBox(o,c,l-o,u-c)}getRotation(){const{startAngle:e,endAngle:t}=this,n=angleBetween(e,t);return normalizeAngle360(e+n/2+Math.PI/2)}updatePath(){const{isBeveled:e}=this;e?this.updateBeveledPath():this.updateRectangularPath(),this.checkPathDirty()}updateRectangularPath(){const{columnWidth:e,innerRadius:t,outerRadius:n,path:i}=this,s=-e/2,r=e/2,a=-n,h=-t,o=this.getRotation(),c=[[s,h],[s,a],[r,a],[r,h]].map(([l,u])=>rotatePoint(l,u,o));i.clear(!0),i.moveTo(c[0].x,c[0].y),i.lineTo(c[1].x,c[1].y),i.lineTo(c[2].x,c[2].y),i.lineTo(c[3].x,c[3].y),i.closePath()}updateBeveledPath(){const{columnWidth:e,path:t,outerRadius:n,innerRadius:i,axisInnerRadius:s,axisOuterRadius:r,isRadiusAxisReversed:a}=this,h=isNumberEqual(i,s),o=Math.asin(e/2/i),c=this.getRotation(),l=(b,C)=>rotatePoint(b,C,c),u=(b,C)=>Math.sqrt(b**2+C**2),d=(b,C)=>C>b?0:Math.sqrt(b**2-C**2),f=(b,C,S)=>S?b<C:b>C,p=h&&!isNaN(o)&&o<Math.PI/6;let m=-e/2,g=e/2;const y=-n,M=-i*(p?Math.cos(o):1),v=f(r,u(i,e/2),!a);if(v){const b=d(r,i);m=-b,g=b}t.clear(!0);const R=l(m,M);t.moveTo(R.x,R.y);const w=isNumberEqual(i,n),P=f(r,u(n,e/2),!a);if(w&&p)t.arc(0,0,i,normalizeAngle360(-o-Math.PI/2)+c,normalizeAngle360(o-Math.PI/2)+c,!1);else if(P){const b=-d(r,e/2),C=d(r,n);if(!v){const S=l(m,b);t.lineTo(S.x,S.y)}if(t.arc(0,0,r,Math.atan2(b,m)+c,Math.atan2(y,-C)+c,!1),!isNumberEqual(C,0)){const S=l(C,y);t.lineTo(S.x,S.y)}t.arc(0,0,r,Math.atan2(y,C)+c,Math.atan2(b,g)+c,!1)}else{const b=l(m,y),C=l(g,y);t.lineTo(b.x,b.y),t.lineTo(C.x,C.y)}const x=l(g,M);if(t.lineTo(x.x,x.y),p)t.arc(0,0,i,normalizeAngle360(o-Math.PI/2)+c,normalizeAngle360(-o-Math.PI/2)+c,!0);else{const b=l(m,M);t.lineTo(b.x,b.y)}t.closePath()}};RadialColumnShape.className="RadialColumnShape",__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"isBeveled",2),__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"columnWidth",2),__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"startAngle",2),__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"endAngle",2),__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"outerRadius",2),__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"innerRadius",2),__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"axisInnerRadius",2),__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"axisOuterRadius",2),__decorateClass([ScenePathChangeDetection()],RadialColumnShape.prototype,"isRadiusAxisReversed",2);function getRadialColumnWidth(e,t,n,i,s){const r=angleBetween(e,t),a=r*(1-i)/2;if(e+=a,t-=a,r<.001)return 2*n*s;if(r>=2*Math.PI){const f=e+r/2;e=f-Math.PI,t=f+Math.PI}const h=n*Math.cos(e),o=n*Math.sin(e),c=n*Math.cos(t),l=n*Math.sin(t),u=Math.floor(Math.sqrt((h-c)**2+(o-l)**2)),d=2*n*s;return Math.max(1,Math.min(d,u))}var drawCorner=(e,{x0:t,y0:n,x1:i,y1:s,cx:r,cy:a},h,o)=>{if(o&&e.moveTo(t,n),t!==i||n!==s){const c=Math.atan2(n-a,t-r),l=Math.atan2(s-a,i-r);e.arc(r,a,h,c,l)}else e.lineTo(t,n)},epsilon=1e-6,cornerEdges=(e,t,n,i,s)=>{let r=!1,a=!1,h=i-Math.sqrt(Math.max(s**2-n**2,0)),o=0,c=0,l=n-Math.sqrt(Math.max(s**2-i**2,0));return h>e?(r=!0,h=e,o=n-Math.sqrt(Math.max(s**2-(i-e)**2))):h<epsilon&&(h=0),l>t?(a=!0,c=i-Math.sqrt(Math.max(s**2-(n-t)**2)),l=t):l<epsilon&&(l=0),{leading0:h,leading1:o,trailing0:c,trailing1:l,leadingClipped:r,trailingClipped:a}},clippedRoundRect=(e,t,n,i,s,r,a)=>{let{topLeft:h,topRight:o,bottomRight:c,bottomLeft:l}=r;const u=Math.max(h+l,o+c),d=Math.max(h+o,l+c);if(u<=0&&d<=0){a==null?e.rect(t,n,i,s):e.rect(a.x,a.y,a.width,a.height);return}else if(a==null&&h===o&&h===c&&h===l){e.roundRect(t,n,i,s,h);return}if(i<0&&(t+=i,i=Math.abs(i)),s<0&&(n+=s,s=Math.abs(s)),i<=0||s<=0)return;if(a==null)a=new BBox(t,n,i,s);else{const x=Math.max(t,a.x),b=Math.min(t+i,a.x+a.width),C=Math.max(n,a.y),S=Math.min(n+s,a.y+a.height);a=new BBox(x,C,b-x,S-C)}const f=Math.max(u/s,d/i,1);f>1&&(h/=f,o/=f,c/=f,l/=f);let p=!0,m=!0,g=!0,y=!0,M,v,R,w;if(p){const x=cornerEdges(a.height,a.width,Math.max(t+h-a.x,0),Math.max(n+h-a.y,0),h);x.leadingClipped&&(y=!1),x.trailingClipped&&(m=!1);const b=Math.max(a.x+x.leading1,a.x),C=Math.max(a.y+x.leading0,a.y),S=Math.max(a.x+x.trailing1,a.x),N=Math.max(a.y+x.trailing0,a.y),D=t+h,F=n+h;M={x0:b,y0:C,x1:S,y1:N,cx:D,cy:F}}if(m){const x=cornerEdges(a.width,a.height,Math.max(n+o-a.y,0),Math.max(a.x+a.width-(t+i-o),0),o);x.leadingClipped&&(p=!1),x.trailingClipped&&(g=!1);const b=Math.min(a.x+a.width-x.leading0,a.x+a.width),C=Math.max(a.y+x.leading1,a.y),S=Math.min(a.x+a.width-x.trailing0,a.x+a.width),N=Math.max(a.y+x.trailing1,a.y),D=t+i-o,F=n+o;v={x0:b,y0:C,x1:S,y1:N,cx:D,cy:F}}if(g){const x=cornerEdges(a.height,a.width,Math.max(a.x+a.width-(t+i-c),0),Math.max(a.y+a.height-(n+s-c),0),c);x.leadingClipped&&(m=!1),x.trailingClipped&&(y=!1);const b=Math.min(a.x+a.width-x.leading1,a.x+a.width),C=Math.min(a.y+a.height-x.leading0,a.y+a.height),S=Math.min(a.x+a.width-x.trailing1,a.x+a.width),N=Math.min(a.y+a.height-x.trailing0,a.y+a.height),D=t+i-c,F=n+s-c;R={x0:b,y0:C,x1:S,y1:N,cx:D,cy:F}}if(y){const x=cornerEdges(a.width,a.height,Math.max(a.y+a.height-(n+s-l),0),Math.max(t+l-a.x,0),l);x.leadingClipped&&(g=!1),x.trailingClipped&&(p=!1);const b=Math.max(a.x+x.leading0,a.x),C=Math.min(a.y+a.height-x.leading1,a.y+a.height),S=Math.max(a.x+x.trailing0,a.x),N=Math.min(a.y+a.height-x.trailing1,a.y+a.height),D=t+l,F=n+s-l;w={x0:b,y0:C,x1:S,y1:N,cx:D,cy:F}}let P=!1;p&&M!=null&&(drawCorner(e,M,h,!P),P||(P=!0)),m&&v!=null&&(drawCorner(e,v,o,!P),P||(P=!0)),g&&R!=null&&(drawCorner(e,R,c,!P),P||(P=!0)),y&&w!=null&&drawCorner(e,w,l,!P),e.closePath()},Rect=class extends Path{constructor(){super(...arguments),this.borderPath=new ExtendedPath2D,this.x=0,this.y=0,this.width=10,this.height=10,this.topLeftCornerRadius=0,this.topRightCornerRadius=0,this.bottomRightCornerRadius=0,this.bottomLeftCornerRadius=0,this.clipBBox=void 0,this.crisp=!1,this.lastUpdatePathStrokeWidth=Shape.defaultStyles.strokeWidth,this.effectiveStrokeWidth=Shape.defaultStyles.strokeWidth,this.hittester=super.isPointInPath.bind(this),this.distanceCalculator=super.distanceSquaredTransformedPoint.bind(this),this.microPixelEffectOpacity=1}set cornerRadius(e){this.topLeftCornerRadius=e,this.topRightCornerRadius=e,this.bottomRightCornerRadius=e,this.bottomLeftCornerRadius=e}isDirtyPath(){return this.lastUpdatePathStrokeWidth!==this.strokeWidth||!!(this.path.isDirty()||this.borderPath.isDirty())}updatePath(){const{path:e,borderPath:t,crisp:n,topLeftCornerRadius:i,topRightCornerRadius:s,bottomRightCornerRadius:r,bottomLeftCornerRadius:a}=this;let{x:h,y:o,width:c,height:l,strokeWidth:u,clipBBox:d}=this;const p=1/(this.layerManager?.canvas.pixelRatio??1);let m=1;if(e.clear(!0),t.clear(!0),n&&(c<=p&&(m*=c/p),l<=p&&(m*=l/p),c=this.align(h,c),l=this.align(o,l),h=this.align(h),o=this.align(o),d=d!=null?new BBox(this.align(d.x),this.align(d.y),this.align(d.x,d.width),this.align(d.y,d.height)):void 0),u)if(c<p){const g=h+p/2;t.moveTo(g,o),t.lineTo(g,o+l),u=p,this.borderClipPath=void 0}else if(l<p){const g=o+p/2;t.moveTo(h,g),t.lineTo(h+c,g),u=p,this.borderClipPath=void 0}else if(u<c&&u<l){const g=u/2;h+=g,o+=g,c-=u,l-=u;const y=d?.clone().shrink(g),M={topLeft:i>0?i-u:0,topRight:s>0?s-u:0,bottomRight:r>0?r-u:0,bottomLeft:a>0?a-u:0};this.borderClipPath=void 0,c>0&&l>0&&(y==null||y?.width>0&&y?.height>0)&&(clippedRoundRect(e,h,o,c,l,M,y),clippedRoundRect(t,h,o,c,l,M,y))}else this.borderClipPath=this.borderClipPath??new ExtendedPath2D,this.borderClipPath.clear(!0),this.borderClipPath.rect(h,o,c,l),t.rect(h,o,c,l);else{const g={topLeft:i,topRight:s,bottomRight:r,bottomLeft:a};this.borderClipPath=void 0,clippedRoundRect(e,h,o,c,l,g,d)}if([i,s,r,a].every(g=>g===0)){const g=this.getBBox();this.hittester=g.containsPoint.bind(g),this.distanceSquared=(y,M)=>this.getBBox().distanceSquared(y,M)}else this.hittester=super.isPointInPath,this.distanceCalculator=super.distanceSquaredTransformedPoint;this.effectiveStrokeWidth=u,this.lastUpdatePathStrokeWidth=u,this.microPixelEffectOpacity=m}computeBBox(){const{x:e,y:t,width:n,height:i,clipBBox:s}=this;return s?.clone()??new BBox(e,t,n,i)}isPointInPath(e,t){return this.hittester(e,t)}get midPoint(){return{x:this.x+this.width/2,y:this.y+this.height/2}}distanceSquared(e,t){return this.distanceCalculator(e,t)}applyFillAlpha(e){const{fillOpacity:t,microPixelEffectOpacity:n,opacity:i}=this;e.globalAlpha*=i*t*n}renderStroke(e){const{stroke:t,effectiveStrokeWidth:n}=this;if(t&&n){const{globalAlpha:i}=e,{strokeOpacity:s,lineDash:r,lineDashOffset:a,lineCap:h,lineJoin:o,borderPath:c,borderClipPath:l,opacity:u,microPixelEffectOpacity:d}=this;l&&e.clip(l.getPath2D()),this.applyStroke(e),e.globalAlpha*=u*s*d,e.lineWidth=n,r&&e.setLineDash(r),a&&(e.lineDashOffset=a),h&&(e.lineCap=h),o&&(e.lineJoin=o),e.stroke(c.getPath2D()),e.globalAlpha=i}}};Rect.className="Rect",__decorateClass([ScenePathChangeDetection()],Rect.prototype,"x",2),__decorateClass([ScenePathChangeDetection()],Rect.prototype,"y",2),__decorateClass([ScenePathChangeDetection()],Rect.prototype,"width",2),__decorateClass([ScenePathChangeDetection()],Rect.prototype,"height",2),__decorateClass([ScenePathChangeDetection()],Rect.prototype,"topLeftCornerRadius",2),__decorateClass([ScenePathChangeDetection()],Rect.prototype,"topRightCornerRadius",2),__decorateClass([ScenePathChangeDetection()],Rect.prototype,"bottomRightCornerRadius",2),__decorateClass([ScenePathChangeDetection()],Rect.prototype,"bottomLeftCornerRadius",2),__decorateClass([ScenePathChangeDetection()],Rect.prototype,"clipBBox",2),__decorateClass([ScenePathChangeDetection()],Rect.prototype,"crisp",2);var SectorBox=class X{constructor(t,n,i,s){this.startAngle=t,this.endAngle=n,this.innerRadius=i,this.outerRadius=s}clone(){const{startAngle:t,endAngle:n,innerRadius:i,outerRadius:s}=this;return new X(t,n,i,s)}equals(t){return this.startAngle===t.startAngle&&this.endAngle===t.endAngle&&this.innerRadius===t.innerRadius&&this.outerRadius===t.outerRadius}[interpolate](t,n){return new X(this.startAngle*(1-n)+t.startAngle*n,this.endAngle*(1-n)+t.endAngle*n,this.innerRadius*(1-n)+t.innerRadius*n,this.outerRadius*(1-n)+t.outerRadius*n)}};function sectorBox({startAngle:e,endAngle:t,innerRadius:n,outerRadius:i}){let s=1/0,r=1/0,a=-1/0,h=-1/0;const o=(c,l)=>{s=Math.min(c,s),r=Math.min(l,r),a=Math.max(c,a),h=Math.max(l,h)};return o(n*Math.cos(e),n*Math.sin(e)),o(n*Math.cos(t),n*Math.sin(t)),o(i*Math.cos(e),i*Math.sin(e)),o(i*Math.cos(t),i*Math.sin(t)),isBetweenAngles(0,e,t)&&o(i,0),isBetweenAngles(Math.PI*.5,e,t)&&o(0,i),isBetweenAngles(Math.PI,e,t)&&o(-i,0),isBetweenAngles(Math.PI*1.5,e,t)&&o(0,-i),new BBox(s,r,a-s,h-r)}function isPointInSector(e,t,n){const i=Math.sqrt(Math.pow(e,2)+Math.pow(t,2)),{innerRadius:s,outerRadius:r}=n;if(n.startAngle===n.endAngle||i<Math.min(s,r)||i>Math.max(s,r))return!1;const a=normalizeAngle180(n.startAngle),h=normalizeAngle180(n.endAngle),o=Math.atan2(t,e);return a<h?o<=h&&o>=a:o<=h&&o>=-Math.PI||o>=a&&o<=Math.PI}function radiiScalingFactor(e,t,n,i){if(n===0&&i===0)return 0;if(Math.asin(Math.abs(1*n)/(e+1*n))+Math.asin(Math.abs(1*i)/(e+1*i))-t<0)return 1;let r=0,a=1;for(let h=0;h<8;h+=1){const o=(r+a)/2;Math.asin(Math.abs(o*n)/(e+o*n))+Math.asin(Math.abs(o*i)/(e+o*i))-t<0?r=o:a=o}return r}var delta2=1e-6;function clockwiseAngle(e,t){return angleBetween(e,t)<delta2?t:normalizeAngle360(e-t)+t}function clockwiseAngles(e,t,n=0){const s=Math.abs(t-e)>=2*Math.PI?2*Math.PI:normalizeAngle360(t-e);return e=clockwiseAngle(e,n),t=e+s,{startAngle:e,endAngle:t}}function arcRadialLineIntersectionAngle(e,t,n,i,s,r){const a=Math.sin(r),h=Math.cos(r),o=e**2+t**2-n**2;let c,l,u,d;if(h>.5){const v=a/h,R=1+v**2,w=-2*(e+t*v),P=w**2-4*R*o;if(P<0)return;const x=(-w+Math.sqrt(P))/(2*R),b=(-w-Math.sqrt(P))/(2*R);c=x,l=x*v,u=b,d=b*v}else{const v=h/a,R=1+v**2,w=-2*(t+e*v),P=w**2-4*R*o;if(P<0)return;const x=(-w+Math.sqrt(P))/(2*R),b=(-w-Math.sqrt(P))/(2*R);c=x*v,l=x,u=b*v,d=b}const f=h,p=a,m=c*f+l*p,g=u*f+d*p,y=m>0?clockwiseAngle(Math.atan2(l-t,c-e),i):NaN,M=g>0?clockwiseAngle(Math.atan2(d-t,u-e),i):NaN;if(y>=i&&y<=s)return y;if(M>=i&&M<=s)return M}function arcCircleIntersectionAngle(e,t,n,i,s,r){const a=Math.hypot(e,t),h=(a**2-n**2+r**2)/(2*a),o=a-h,c=Math.atan2(t,e),l=Math.acos(-o/n),u=clockwiseAngle(c+l,i),d=clockwiseAngle(c-l,i);if(u>=i&&u<=s)return u;if(d>=i&&d<=s)return d}var Arc2=class{constructor(e,t,n,i,s){this.cx=e,this.cy=t,this.r=n,this.a0=i,this.a1=s,this.a0>=this.a1&&(this.a0=NaN,this.a1=NaN)}isValid(){return Number.isFinite(this.a0)&&Number.isFinite(this.a1)}pointAt(e){return{x:this.cx+this.r*Math.cos(e),y:this.cy+this.r*Math.sin(e)}}clipStart(e){e==null||!this.isValid()||e<this.a0||(this.a0=e,(Number.isNaN(e)||this.a0>=this.a1)&&(this.a0=NaN,this.a1=NaN))}clipEnd(e){e==null||!this.isValid()||e>this.a1||(this.a1=e,(Number.isNaN(e)||this.a0>=this.a1)&&(this.a0=NaN,this.a1=NaN))}},Sector=class extends Path{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.innerRadius=10,this.outerRadius=20,this.startAngle=0,this.endAngle=Math.PI*2,this.clipSector=void 0,this.concentricEdgeInset=0,this.radialEdgeInset=0,this.startOuterCornerRadius=0,this.endOuterCornerRadius=0,this.startInnerCornerRadius=0,this.endInnerCornerRadius=0}set inset(e){this.concentricEdgeInset=e,this.radialEdgeInset=e}set cornerRadius(e){this.startOuterCornerRadius=e,this.endOuterCornerRadius=e,this.startInnerCornerRadius=e,this.endInnerCornerRadius=e}computeBBox(){return sectorBox(this).translate(this.centerX,this.centerY)}normalizedRadii(){const{concentricEdgeInset:e}=this;let{innerRadius:t,outerRadius:n}=this;return t=t>0?t+e:0,n=Math.max(n-e,0),{innerRadius:t,outerRadius:n}}normalizedClipSector(){const{clipSector:e}=this;if(e==null)return;const{startAngle:t,endAngle:n}=clockwiseAngles(this.startAngle,this.endAngle),{innerRadius:i,outerRadius:s}=this.normalizedRadii(),r=clockwiseAngles(e.startAngle,e.endAngle,t);return new SectorBox(Math.max(t,r.startAngle),Math.min(n,r.endAngle),Math.max(i,e.innerRadius),Math.min(s,e.outerRadius))}getAngleOffset(e){return e>0?this.radialEdgeInset/e:0}arc(e,t,n,i,s,r,a,h){if(e<=0)return;const{startAngle:o,endAngle:c}=clockwiseAngles(this.startAngle,this.endAngle),{innerRadius:l,outerRadius:u}=this.normalizedRadii(),d=this.normalizedClipSector();if(h&&l<=0)return;const f=h?this.getAngleOffset(l+e):this.getAngleOffset(u-e),p=a?o+f+t:c-f-t,m=h?l+e:u-e,g=m*Math.cos(p),y=m*Math.sin(p);if(d!=null&&(!a&&!(p>=o-1e-6&&p<=d.endAngle-1e-6)||a&&!(p>=d.startAngle+1e-6&&p<=c-1e-6)||h&&m<d.innerRadius-1e-6||!h&&m>d.outerRadius+1e-6))return;const M=new Arc2(g,y,e,n,i);if(d!=null){h?(M.clipStart(arcRadialLineIntersectionAngle(g,y,e,n,i,d.endAngle)),M.clipEnd(arcRadialLineIntersectionAngle(g,y,e,n,i,d.startAngle))):(M.clipStart(arcRadialLineIntersectionAngle(g,y,e,n,i,d.startAngle)),M.clipEnd(arcRadialLineIntersectionAngle(g,y,e,n,i,d.endAngle)));let x,b;if(a?(x=arcCircleIntersectionAngle(g,y,e,n,i,d.innerRadius),b=arcCircleIntersectionAngle(g,y,e,n,i,d.outerRadius)):(x=arcCircleIntersectionAngle(g,y,e,n,i,d.outerRadius),b=arcCircleIntersectionAngle(g,y,e,n,i,d.innerRadius)),M.clipStart(x),M.clipEnd(b),x!=null){const{x:C,y:S}=M.pointAt(x),N=clockwiseAngle(Math.atan2(S,C),o);a?r?.clipStart(N):s.clipEnd(N)}if(b!=null){const{x:C,y:S}=M.pointAt(b),N=clockwiseAngle(Math.atan2(S,C),o);a?s.clipStart(N):r?.clipEnd(N)}}if(d!=null){const{x,y:b}=M.pointAt((M.a0+M.a1)/2);if(!isPointInSector(x,b,d))return}const{x:v,y:R}=M.pointAt(a===h?M.a0:M.a1),w=clockwiseAngle(Math.atan2(R,v),o),P=h?r:s;return a?P?.clipStart(w):P?.clipEnd(w),M}updatePath(){const{path:t,centerX:n,centerY:i,concentricEdgeInset:s,radialEdgeInset:r}=this;let{startOuterCornerRadius:a,endOuterCornerRadius:h,startInnerCornerRadius:o,endInnerCornerRadius:c}=this;const{startAngle:l,endAngle:u}=clockwiseAngles(this.startAngle,this.endAngle),{innerRadius:d,outerRadius:f}=this.normalizedRadii(),p=this.normalizedClipSector(),m=u-l,g=m>=2*Math.PI-1e-6;if(t.clear(),d===0&&f===0||d>f)return;if((p?.startAngle??l)===(p?.endAngle??u))return;if(g&&this.clipSector==null&&a===0&&h===0&&o===0&&c===0){t.moveTo(n+f*Math.cos(l),i+f*Math.sin(l)),t.arc(n,i,f,l,u),d>s&&(t.moveTo(n+d*Math.cos(u),i+d*Math.sin(u)),t.arc(n,i,d,u,l,!0)),t.closePath();return}else if(this.clipSector==null&&Math.abs(d-f)<1e-6){t.arc(n,i,f,l,u,!1),t.arc(n,i,f,u,l,!0),t.closePath();return}const y=this.getAngleOffset(d),M=this.getAngleOffset(f);if(m<2*M)return;const R=(p?.innerRadius??d)>s,w=d<s||m<2*y,P=f-d,x=Math.max(a,o,h,c),b=x>0?Math.min(P/x,1):1;a*=b,h*=b,o*=b,c*=b;const C=radiiScalingFactor(f,m-2*M,-a,-h);if(a*=C,h*=C,!w&&R){const T=radiiScalingFactor(d,m-2*y,o,c);o*=T,c*=T}else o=0,c=0;const S=Math.max(a+o,h+c),N=S>0?Math.min(P/S,1):1;a*=N,h*=N,o*=N,c*=N;let D=0,F=0;const H=a/(f-a),j=h/(f-h);if(H>=0&&H<1-1e-6)D=Math.asin(H);else{D=m/2;const T=f/(1/Math.sin(D)+1);a=Math.min(T,a)}if(j>=0&&j<1-1e-6)F=Math.asin(j);else{F=m/2;const T=f/(1/Math.sin(F)+1);h=Math.min(T,h)}const V=Math.asin(o/(d+o)),U=Math.asin(c/(d+c)),J=p?.outerRadius??f,Z=this.getAngleOffset(J),B=new Arc2(0,0,J,l+Z,u-Z),K=p?.innerRadius??d,Q=this.getAngleOffset(K),E=R?new Arc2(0,0,K,l+Q,u-Q):void 0;p!=null&&(B.clipStart(p.startAngle),B.clipEnd(p.endAngle),E?.clipStart(p.startAngle),E?.clipEnd(p.endAngle));const tt=this.arc(a,D,l-Math.PI*.5,l+D,B,E,!0,!1),et=this.arc(h,F,u-F,u+Math.PI*.5,B,E,!1,!1),nt=this.arc(c,U,u+Math.PI*.5,u+Math.PI-U,B,E,!1,!0),q=this.arc(o,V,l+Math.PI+V,l+Math.PI*1.5,B,E,!0,!0);if(w){const T=m<Math.PI*.5?r*(1+Math.cos(m))/Math.sin(m):NaN;let k;T>0&&T<f?k=Math.max(Math.hypot(r,T),d):k=r,k=Math.max(k,d);const I=l+m*.5;t.moveTo(n+k*Math.cos(I),i+k*Math.sin(I))}else if(!(q?.isValid()===!0||E?.isValid()===!0)){const T=l+m/2,k=d*Math.cos(T),I=d*Math.sin(T);t.moveTo(n+k,i+I)}if(tt?.isValid()===!0){const{cx:T,cy:k,r:I,a0:L,a1:_}=tt;t.arc(n+T,i+k,I,L,_)}if(B.isValid()){const{r:T,a0:k,a1:I}=B;t.arc(n,i,T,k,I)}if(et?.isValid()===!0){const{cx:T,cy:k,r:I,a0:L,a1:_}=et;t.arc(n+T,i+k,I,L,_)}if(!w){if(nt?.isValid()===!0){const{cx:T,cy:k,r:I,a0:L,a1:_}=nt;t.arc(n+T,i+k,I,L,_)}if(E?.isValid()===!0){const{r:T,a0:k,a1:I}=E;t.arc(n,i,T,I,k,!0)}if(q?.isValid()===!0){const{cx:T,cy:k,r:I,a0:L,a1:_}=q;t.arc(n+T,i+k,I,L,_)}}t.closePath()}isPointInPath(e,t){const{startAngle:n,endAngle:i,innerRadius:s,outerRadius:r}=this.clipSector??this;return isPointInSector(e-this.centerX,t-this.centerY,{startAngle:n,endAngle:i,innerRadius:Math.min(s,r),outerRadius:Math.max(s,r)})}};Sector.className="Sector",__decorateClass([ScenePathChangeDetection()],Sector.prototype,"centerX",2),__decorateClass([ScenePathChangeDetection()],Sector.prototype,"centerY",2),__decorateClass([ScenePathChangeDetection()],Sector.prototype,"innerRadius",2),__decorateClass([ScenePathChangeDetection()],Sector.prototype,"outerRadius",2),__decorateClass([ScenePathChangeDetection()],Sector.prototype,"startAngle",2),__decorateClass([ScenePathChangeDetection()],Sector.prototype,"endAngle",2),__decorateClass([ScenePathChangeDetection()],Sector.prototype,"clipSector",2),__decorateClass([ScenePathChangeDetection()],Sector.prototype,"concentricEdgeInset",2),__decorateClass([ScenePathChangeDetection()],Sector.prototype,"radialEdgeInset",2),__decorateClass([ScenePathChangeDetection()],Sector.prototype,"startOuterCornerRadius",2),__decorateClass([ScenePathChangeDetection()],Sector.prototype,"endOuterCornerRadius",2),__decorateClass([ScenePathChangeDetection()],Sector.prototype,"startInnerCornerRadius",2),__decorateClass([ScenePathChangeDetection()],Sector.prototype,"endInnerCornerRadius",2);
