{"ast":null,"code":"var _jsxFileName = \"/home/user/agrivision/frontend/src/components/Dashboard/ImageAnalysisModal.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport Modal from 'react-modal';\nimport { X, Loader, ZoomIn } from 'lucide-react';\nimport ImagePreviewModal from './ImagePreviewModal';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst AI_MODELS = [{\n  id: 'blur',\n  name: 'Flou Gaussien',\n  description: \"Appliquer un effet de flou sur l'image\",\n  endpoint: 'http://localhost:5008/api/blur',\n  type: 'detection'\n}, {\n  id: \"disease-detection\",\n  name: \"Détection des maladies\",\n  description: \"Identifier les maladies sur les feuilles des plantes.\",\n  endpoint: \"http://localhost:5007/api/disease-detection\",\n  type: 'analysis'\n}, {\n  id: \"fruit-quality\",\n  name: \"Classification et Qualité des Fruits\",\n  description: \"Analyser et classifier les fruits tout en vérifiant leur qualité.\",\n  endpoint: \"http://localhost:5000/api/predict\",\n  type: 'analysis'\n}, {\n  id: 'ndvi',\n  name: 'Carte NDVI',\n  description: \"Analyser les besoins en irrigation à l'aide de l'indice NDVI\",\n  endpoint: 'http://localhost:5001/api/ndvi',\n  type: 'analysis'\n}, {\n  id: 'edge-detection',\n  name: 'Détection des contours',\n  description: 'Détecter les contours de l\\'image',\n  endpoint: 'http://localhost:5004/api/edge-detection',\n  type: 'detection'\n}, {\n  id: 'tree-detection',\n  name: 'Détection des Arbres',\n  description: 'Détecter et compter les arbres',\n  endpoint: 'http://localhost:5003/api/analyze-trees',\n  type: 'detection'\n}];\nconst ResultDisplay = ({\n  model,\n  result,\n  processedImage,\n  onImageClick\n}) => {\n  // Pour les modèles qui retournent uniquement des données textuelles\n  if (model.id === 'disease-detection' || model.id === 'fruit-quality') {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-lg p-6 h-full\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col h-full justify-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-xl font-semibold text-green-700 mb-4\",\n          children: \"R\\xE9sultats de l'analyse\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 9\n        }, this), model.id === 'disease-detection' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-green-50 p-4 rounded-lg\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-lg font-medium\",\n              children: \"Maladie d\\xE9tect\\xE9e :\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 61,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-2xl text-green-700\",\n              children: result.data.disease\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 62,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 60,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-blue-50 p-4 rounded-lg\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-lg font-medium\",\n              children: \"Niveau de confiance :\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 65,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-1 bg-gray-200 rounded-full h-4\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"bg-blue-600 rounded-full h-4\",\n                  style: {\n                    width: `${result.data.confidence}%`\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 68,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 67,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-lg font-semibold\",\n                children: [result.data.confidence, \"%\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 73,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 66,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 11\n        }, this), model.id === 'fruit-quality' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-green-50 p-4 rounded-lg\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-lg font-medium\",\n              children: \"Type de fruit :\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-2xl text-green-700\",\n              children: result.data.fruit\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 82,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-blue-50 p-4 rounded-lg\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-lg font-medium\",\n                children: \"Fra\\xEEcheur :\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 86,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center space-x-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex-1 bg-gray-200 rounded-full h-4\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"bg-green-600 rounded-full h-4\",\n                    style: {\n                      width: `${result.data.freshness}%`\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 89,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 88,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"text-lg font-semibold\",\n                  children: [result.data.freshness, \"%\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 94,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 87,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 5\n    }, this);\n  }\n\n  // Pour tree-detection, afficher l'image ET le nombre d'arbres\n  if (model.id === 'tree-detection') {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative aspect-video bg-white rounded-lg overflow-hidden group cursor-pointer\",\n        onClick: () => onImageClick(processedImage),\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: processedImage,\n          alt: \"R\\xE9sultat\",\n          className: \"object-contain w-full h-full\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 flex items-center justify-center transition-opacity\",\n          children: /*#__PURE__*/_jsxDEV(ZoomIn, {\n            className: \"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-lg p-4 shadow\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold text-green-700 mb-2\",\n          children: \"R\\xE9sultats\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Nombre d'arbres d\\xE9tect\\xE9s : \", result.tree_count]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 5\n    }, this);\n  }\n\n  // Pour les autres modèles qui retournent une image\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"relative aspect-video bg-white rounded-lg overflow-hidden group cursor-pointer\",\n    onClick: () => onImageClick(processedImage),\n    children: [/*#__PURE__*/_jsxDEV(\"img\", {\n      src: processedImage,\n      alt: \"R\\xE9sultat\",\n      className: \"object-contain w-full h-full\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 flex items-center justify-center transition-opacity\",\n      children: /*#__PURE__*/_jsxDEV(ZoomIn, {\n        className: \"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 132,\n    columnNumber: 3\n  }, this);\n};\n_c = ResultDisplay;\nexport default function ImageAnalysisModal({\n  isOpen,\n  onClose,\n  selectedImage\n}) {\n  _s();\n  const [processedImageUrl, setProcessedImageUrl] = useState(null);\n  const [processing, setProcessing] = useState(false);\n  const [error, setError] = useState(null);\n  const [selectedModel, setSelectedModel] = useState(null);\n  const [previewImage, setPreviewImage] = useState(null);\n  const [selectedType, setSelectedType] = useState('analysis');\n  const [analysisResults, setAnalysisResults] = useState(null);\n  const filteredModels = AI_MODELS.filter(model => model.type === selectedType);\n  const handleModelSelect = async model => {\n    if (!selectedImage) {\n      setError(\"Aucune image sélectionnée.\");\n      return;\n    }\n    setProcessedImageUrl(null);\n    setAnalysisResults(null);\n    setProcessing(true);\n    setError(null);\n    setSelectedModel(model);\n    try {\n      const fullImagePath = `${process.env.REACT_APP_FILE_SERVICE_URL}${selectedImage.file_path}`;\n      const response = await fetch(model.endpoint, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          imagePath: fullImagePath\n        })\n      });\n      if (!response.ok) throw new Error('Erreur lors du traitement de l\\'image');\n      const result = await response.json();\n      setProcessedImageUrl(result.processedImageUrl);\n      setAnalysisResults(result);\n    } catch (err) {\n      setError(err.message);\n      setProcessedImageUrl(null);\n      setAnalysisResults(null);\n    } finally {\n      setProcessing(false);\n    }\n  };\n  const handleClose = () => {\n    setProcessedImageUrl(null);\n    setError(null);\n    setSelectedModel(null);\n    setPreviewImage(null);\n    setAnalysisResults(null);\n    onClose();\n  };\n  const handleOriginalImageClick = () => {\n    setPreviewImage(selectedImage);\n  };\n  const handleProcessedImageClick = imageUrl => {\n    if (imageUrl) {\n      setPreviewImage({\n        file_path: imageUrl.replace(process.env.REACT_APP_FILE_SERVICE_URL, '')\n      });\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: isOpen,\n      onRequestClose: handleClose,\n      className: \"bg-white rounded-xl max-w-7xl mx-auto mt-10 p-0 h-[80vh] overflow-hidden\",\n      overlayClassName: \"fixed inset-0 bg-black bg-opacity-50 flex items-start\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col h-full\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-center p-4 border-b\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-xl font-semibold text-gray-800\",\n            children: \"Analyse d'Image avec IA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleClose,\n            className: \"p-2 hover:bg-gray-100 rounded-full\",\n            children: /*#__PURE__*/_jsxDEV(X, {\n              className: \"w-5 h-5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 228,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-1 min-h-0\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-64 border-r bg-gray-50 p-4 overflow-y-auto\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mb-4\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between p-2 bg-white rounded-lg shadow-sm\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => setSelectedType('analysis'),\n                  className: `px-3 py-1 rounded-md transition ${selectedType === 'analysis' ? 'bg-green-100 text-green-700' : 'hover:bg-gray-100'}`,\n                  children: \"Analysis\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 236,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => setSelectedType('detection'),\n                  className: `px-3 py-1 rounded-md transition ${selectedType === 'detection' ? 'bg-green-100 text-green-700' : 'hover:bg-gray-100'}`,\n                  children: \"Detection\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 246,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 235,\n                columnNumber: 15\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"font-medium text-gray-700 mb-4\",\n              children: \"Mod\\xE8les disponibles\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-2\",\n              children: filteredModels.map(model => /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleModelSelect(model),\n                disabled: processing,\n                className: `w-full p-3 rounded-lg text-left transition ${(selectedModel === null || selectedModel === void 0 ? void 0 : selectedModel.id) === model.id ? 'bg-green-100 text-green-700' : 'hover:bg-gray-100'}`,\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"font-medium\",\n                  children: model.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 272,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-sm text-gray-500\",\n                  children: model.description\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 273,\n                  columnNumber: 19\n                }, this)]\n              }, model.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 262,\n                columnNumber: 17\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-1 p-6 overflow-y-auto\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-2 gap-6 h-full\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-gray-50 rounded-lg p-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  className: \"text-sm font-medium text-gray-500 mb-2\",\n                  children: \"Image originale\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 282,\n                  columnNumber: 17\n                }, this), selectedImage !== null && selectedImage !== void 0 && selectedImage.file_path ? /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"cursor-pointer\",\n                  onClick: handleOriginalImageClick,\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"relative aspect-video bg-white rounded-lg overflow-hidden group\",\n                    children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                      src: `${process.env.REACT_APP_FILE_SERVICE_URL}${selectedImage.file_path}`,\n                      alt: \"Original\",\n                      className: \"object-contain w-full h-full\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 286,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 flex items-center justify-center transition-opacity\",\n                      children: /*#__PURE__*/_jsxDEV(ZoomIn, {\n                        className: \"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 292,\n                        columnNumber: 25\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 291,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 285,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 284,\n                  columnNumber: 19\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-center h-full text-gray-400\",\n                  children: \"Chargement de l'image...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 297,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 281,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"bg-gray-50 rounded-lg p-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  className: \"text-sm font-medium text-gray-500 mb-2\",\n                  children: \"R\\xE9sultat\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 304,\n                  columnNumber: 17\n                }, this), processing ? /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-center h-full\",\n                  children: /*#__PURE__*/_jsxDEV(Loader, {\n                    className: \"w-8 h-8 animate-spin text-green-600 mx-auto\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 307,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 306,\n                  columnNumber: 19\n                }, this) : analysisResults ? /*#__PURE__*/_jsxDEV(ResultDisplay, {\n                  model: selectedModel,\n                  result: analysisResults,\n                  processedImage: processedImageUrl,\n                  onImageClick: handleProcessedImageClick\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 310,\n                  columnNumber: 19\n                }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-center h-full text-gray-400\",\n                  children: \"Aucun r\\xE9sultat disponible\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 317,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 303,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 280,\n              columnNumber: 13\n            }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-600\",\n              children: error\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 325,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(ImagePreviewModal, {\n      isOpen: previewImage !== null,\n      onClose: () => setPreviewImage(null),\n      image: previewImage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true);\n}\n_s(ImageAnalysisModal, \"Fr62DdAoOcjz2jDVEySK2z5DdvA=\");\n_c2 = ImageAnalysisModal;\nvar _c, _c2;\n$RefreshReg$(_c, \"ResultDisplay\");\n$RefreshReg$(_c2, \"ImageAnalysisModal\");","map":{"version":3,"names":["React","useState","Modal","X","Loader","ZoomIn","ImagePreviewModal","jsxDEV","_jsxDEV","Fragment","_Fragment","AI_MODELS","id","name","description","endpoint","type","ResultDisplay","model","result","processedImage","onImageClick","className","children","fileName","_jsxFileName","lineNumber","columnNumber","data","disease","style","width","confidence","fruit","freshness","onClick","src","alt","tree_count","_c","ImageAnalysisModal","isOpen","onClose","selectedImage","_s","processedImageUrl","setProcessedImageUrl","processing","setProcessing","error","setError","selectedModel","setSelectedModel","previewImage","setPreviewImage","selectedType","setSelectedType","analysisResults","setAnalysisResults","filteredModels","filter","handleModelSelect","fullImagePath","process","env","REACT_APP_FILE_SERVICE_URL","file_path","response","fetch","method","headers","body","JSON","stringify","imagePath","ok","Error","json","err","message","handleClose","handleOriginalImageClick","handleProcessedImageClick","imageUrl","replace","onRequestClose","overlayClassName","map","disabled","image","_c2","$RefreshReg$"],"sources":["/home/user/agrivision/frontend/src/components/Dashboard/ImageAnalysisModal.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport Modal from 'react-modal';\r\nimport { X, Loader, ZoomIn } from 'lucide-react';\r\nimport ImagePreviewModal from './ImagePreviewModal';\r\n\r\nconst AI_MODELS = [\r\n{\r\n  id: 'blur',\r\n  name: 'Flou Gaussien',\r\n  description: \"Appliquer un effet de flou sur l'image\",\r\n  endpoint: 'http://localhost:5008/api/blur',\r\n  type: 'detection'\r\n},\r\n{\r\n  id: \"disease-detection\",\r\n  name: \"Détection des maladies\",\r\n  description: \"Identifier les maladies sur les feuilles des plantes.\",\r\n  endpoint: \"http://localhost:5007/api/disease-detection\",\r\n  type: 'analysis'\r\n},\r\n{\r\n  id: \"fruit-quality\",\r\n  name: \"Classification et Qualité des Fruits\",\r\n  description: \"Analyser et classifier les fruits tout en vérifiant leur qualité.\",\r\n  endpoint: \"http://localhost:5000/api/predict\",\r\n  type: 'analysis'\r\n},\r\n{\r\n  id: 'ndvi',\r\n  name: 'Carte NDVI',\r\n  description: \"Analyser les besoins en irrigation à l'aide de l'indice NDVI\",\r\n  endpoint: 'http://localhost:5001/api/ndvi',\r\n  type: 'analysis'\r\n},\r\n{\r\n  id: 'edge-detection',\r\n  name: 'Détection des contours',\r\n  description: 'Détecter les contours de l\\'image',\r\n  endpoint: 'http://localhost:5004/api/edge-detection',\r\n  type: 'detection'\r\n},\r\n{\r\n  id: 'tree-detection',\r\n  name: 'Détection des Arbres',\r\n  description: 'Détecter et compter les arbres',\r\n  endpoint: 'http://localhost:5003/api/analyze-trees',\r\n  type: 'detection'\r\n}\r\n];\r\n\r\nconst ResultDisplay = ({ model, result, processedImage, onImageClick }) => {\r\n// Pour les modèles qui retournent uniquement des données textuelles\r\nif (model.id === 'disease-detection' || model.id === 'fruit-quality') {\r\n  return (\r\n    <div className=\"bg-white rounded-lg p-6 h-full\">\r\n      <div className=\"flex flex-col h-full justify-center\">\r\n        <h3 className=\"text-xl font-semibold text-green-700 mb-4\">Résultats de l'analyse</h3>\r\n        {model.id === 'disease-detection' && (\r\n          <div className=\"space-y-4\">\r\n            <div className=\"bg-green-50 p-4 rounded-lg\">\r\n              <p className=\"text-lg font-medium\">Maladie détectée :</p>\r\n              <p className=\"text-2xl text-green-700\">{result.data.disease}</p>\r\n            </div>\r\n            <div className=\"bg-blue-50 p-4 rounded-lg\">\r\n              <p className=\"text-lg font-medium\">Niveau de confiance :</p>\r\n              <div className=\"flex items-center space-x-2\">\r\n                <div className=\"flex-1 bg-gray-200 rounded-full h-4\">\r\n                  <div \r\n                    className=\"bg-blue-600 rounded-full h-4\"\r\n                    style={{ width: `${result.data.confidence}%` }}\r\n                  ></div>\r\n                </div>\r\n                <span className=\"text-lg font-semibold\">{result.data.confidence}%</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n        {model.id === 'fruit-quality' && (\r\n          <div className=\"space-y-4\">\r\n            <div className=\"bg-green-50 p-4 rounded-lg\">\r\n              <p className=\"text-lg font-medium\">Type de fruit :</p>\r\n              <p className=\"text-2xl text-green-700\">{result.data.fruit}</p>\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n              <div className=\"bg-blue-50 p-4 rounded-lg\">\r\n                <p className=\"text-lg font-medium\">Fraîcheur :</p>\r\n                <div className=\"flex items-center space-x-2\">\r\n                  <div className=\"flex-1 bg-gray-200 rounded-full h-4\">\r\n                    <div \r\n                      className=\"bg-green-600 rounded-full h-4\"\r\n                      style={{ width: `${result.data.freshness}%` }}\r\n                    ></div>\r\n                  </div>\r\n                  <span className=\"text-lg font-semibold\">{result.data.freshness}%</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Pour tree-detection, afficher l'image ET le nombre d'arbres\r\nif (model.id === 'tree-detection') {\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div \r\n        className=\"relative aspect-video bg-white rounded-lg overflow-hidden group cursor-pointer\"\r\n        onClick={() => onImageClick(processedImage)}\r\n      >\r\n        <img\r\n          src={processedImage}\r\n          alt=\"Résultat\"\r\n          className=\"object-contain w-full h-full\"\r\n        />\r\n        <div className=\"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 flex items-center justify-center transition-opacity\">\r\n          <ZoomIn className=\"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n        </div>\r\n      </div>\r\n      <div className=\"bg-white rounded-lg p-4 shadow\">\r\n        <h3 className=\"text-lg font-semibold text-green-700 mb-2\">Résultats</h3>\r\n        <p>Nombre d'arbres détectés : {result.tree_count}</p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Pour les autres modèles qui retournent une image\r\nreturn (\r\n  <div \r\n    className=\"relative aspect-video bg-white rounded-lg overflow-hidden group cursor-pointer\"\r\n    onClick={() => onImageClick(processedImage)}\r\n  >\r\n    <img\r\n      src={processedImage}\r\n      alt=\"Résultat\"\r\n      className=\"object-contain w-full h-full\"\r\n    />\r\n    <div className=\"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 flex items-center justify-center transition-opacity\">\r\n      <ZoomIn className=\"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n    </div>\r\n  </div>\r\n);\r\n};\r\n\r\nexport default function ImageAnalysisModal({ isOpen, onClose, selectedImage }) {\r\nconst [processedImageUrl, setProcessedImageUrl] = useState(null);\r\nconst [processing, setProcessing] = useState(false);\r\nconst [error, setError] = useState(null);\r\nconst [selectedModel, setSelectedModel] = useState(null);\r\nconst [previewImage, setPreviewImage] = useState(null);\r\nconst [selectedType, setSelectedType] = useState('analysis');\r\nconst [analysisResults, setAnalysisResults] = useState(null);\r\n\r\nconst filteredModels = AI_MODELS.filter(model => model.type === selectedType);\r\n\r\nconst handleModelSelect = async (model) => {\r\n  if (!selectedImage) {\r\n    setError(\"Aucune image sélectionnée.\");\r\n    return;\r\n  }\r\n\r\n  setProcessedImageUrl(null);\r\n  setAnalysisResults(null);\r\n  setProcessing(true);\r\n  setError(null);\r\n  setSelectedModel(model);\r\n\r\n  try {\r\n    const fullImagePath = `${process.env.REACT_APP_FILE_SERVICE_URL}${selectedImage.file_path}`;\r\n\r\n    const response = await fetch(model.endpoint, {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ imagePath: fullImagePath }),\r\n    });\r\n\r\n    if (!response.ok) throw new Error('Erreur lors du traitement de l\\'image');\r\n\r\n    const result = await response.json();\r\n    setProcessedImageUrl(result.processedImageUrl);\r\n    setAnalysisResults(result);\r\n\r\n  } catch (err) {\r\n    setError(err.message);\r\n    setProcessedImageUrl(null);\r\n    setAnalysisResults(null);\r\n  } finally {\r\n    setProcessing(false);\r\n  }\r\n};\r\n\r\nconst handleClose = () => {\r\n  setProcessedImageUrl(null);\r\n  setError(null);\r\n  setSelectedModel(null);\r\n  setPreviewImage(null);\r\n  setAnalysisResults(null);\r\n  onClose();\r\n};\r\n\r\nconst handleOriginalImageClick = () => {\r\n  setPreviewImage(selectedImage);\r\n};\r\n\r\nconst handleProcessedImageClick = (imageUrl) => {\r\n  if (imageUrl) {\r\n    setPreviewImage({\r\n      file_path: imageUrl.replace(process.env.REACT_APP_FILE_SERVICE_URL, '')\r\n    });\r\n  }\r\n};\r\n\r\nreturn (\r\n  <>\r\n    <Modal\r\n      isOpen={isOpen}\r\n      onRequestClose={handleClose}\r\n      className=\"bg-white rounded-xl max-w-7xl mx-auto mt-10 p-0 h-[80vh] overflow-hidden\"\r\n      overlayClassName=\"fixed inset-0 bg-black bg-opacity-50 flex items-start\"\r\n    >\r\n      <div className=\"flex flex-col h-full\">\r\n        <div className=\"flex justify-between items-center p-4 border-b\">\r\n          <h2 className=\"text-xl font-semibold text-gray-800\">Analyse d'Image avec IA</h2>\r\n          <button onClick={handleClose} className=\"p-2 hover:bg-gray-100 rounded-full\">\r\n            <X className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"flex flex-1 min-h-0\">\r\n          <div className=\"w-64 border-r bg-gray-50 p-4 overflow-y-auto\">\r\n            <div className=\"mb-4\">\r\n              <div className=\"flex items-center justify-between p-2 bg-white rounded-lg shadow-sm\">\r\n                <button\r\n                  onClick={() => setSelectedType('analysis')}\r\n                  className={`px-3 py-1 rounded-md transition ${\r\n                    selectedType === 'analysis'\r\n                      ? 'bg-green-100 text-green-700'\r\n                      : 'hover:bg-gray-100'\r\n                  }`}\r\n                >\r\n                  Analysis\r\n                </button>\r\n                <button\r\n                  onClick={() => setSelectedType('detection')}\r\n                  className={`px-3 py-1 rounded-md transition ${\r\n                    selectedType === 'detection'\r\n                      ? 'bg-green-100 text-green-700'\r\n                      : 'hover:bg-gray-100'\r\n                  }`}\r\n                >\r\n                  Detection\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <h3 className=\"font-medium text-gray-700 mb-4\">Modèles disponibles</h3>\r\n            <div className=\"space-y-2\">\r\n              {filteredModels.map((model) => (\r\n                <button\r\n                  key={model.id}\r\n                  onClick={() => handleModelSelect(model)}\r\n                  disabled={processing}\r\n                  className={`w-full p-3 rounded-lg text-left transition ${\r\n                    selectedModel?.id === model.id\r\n                      ? 'bg-green-100 text-green-700'\r\n                      : 'hover:bg-gray-100'\r\n                  }`}\r\n                >\r\n                  <div className=\"font-medium\">{model.name}</div>\r\n                  <div className=\"text-sm text-gray-500\">{model.description}</div>\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"flex-1 p-6 overflow-y-auto\">\r\n            <div className=\"grid grid-cols-2 gap-6 h-full\">\r\n              <div className=\"bg-gray-50 rounded-lg p-4\">\r\n                <h4 className=\"text-sm font-medium text-gray-500 mb-2\">Image originale</h4>\r\n                {selectedImage?.file_path ? (\r\n                  <div className=\"cursor-pointer\" onClick={handleOriginalImageClick}>\r\n                    <div className=\"relative aspect-video bg-white rounded-lg overflow-hidden group\">\r\n                      <img\r\n                        src={`${process.env.REACT_APP_FILE_SERVICE_URL}${selectedImage.file_path}`}\r\n                        alt=\"Original\"\r\n                        className=\"object-contain w-full h-full\"\r\n                      />\r\n                      <div className=\"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 flex items-center justify-center transition-opacity\">\r\n                        <ZoomIn className=\"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"flex items-center justify-center h-full text-gray-400\">\r\n                    Chargement de l'image...\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"bg-gray-50 rounded-lg p-4\">\r\n                <h4 className=\"text-sm font-medium text-gray-500 mb-2\">Résultat</h4>\r\n                {processing ? (\r\n                  <div className=\"flex items-center justify-center h-full\">\r\n                    <Loader className=\"w-8 h-8 animate-spin text-green-600 mx-auto\" />\r\n                  </div>\r\n                ) : analysisResults ? (\r\n                  <ResultDisplay\r\n                    model={selectedModel}\r\n                    result={analysisResults}\r\n                    processedImage={processedImageUrl}\r\n                    onImageClick={handleProcessedImageClick}\r\n                  />\r\n                ) : (\r\n                  <div className=\"flex items-center justify-center h-full text-gray-400\">\r\n                    Aucun résultat disponible\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {error && (\r\n              <div className=\"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-600\">\r\n                {error}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n\r\n    <ImagePreviewModal\r\n      isOpen={previewImage !== null}\r\n      onClose={() => setPreviewImage(null)}\r\n      image={previewImage}\r\n    />\r\n  </>\r\n);\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}